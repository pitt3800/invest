<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ¯ ìŠ¤ë§ˆíŠ¸ íˆ¬ìê³„íš ì‹œìŠ¤í…œ (ë¬´í•œë£¨í”„ ìˆ˜ì •)</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <style>
        /* ê¸°ë³¸ ìŠ¤íƒ€ì¼ */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            padding: 30px;
        }
        
        /* í—¤ë” ìŠ¤íƒ€ì¼ */
        .header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            border-radius: 15px;
            color: white;
        }
        
        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }
        
        .header p {
            font-size: 1.2em;
            opacity: 0.9;
        }
        
        /* íˆ¬ì ìš”ì•½ ì •ë³´ */
        .investment-summary {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 20px 0;
            background: rgba(255, 255, 255, 0.2);
            padding: 20px;
            border-radius: 10px;
        }
        
        .summary-item {
            text-align: center;
        }
        
        .summary-label {
            font-size: 0.9em;
            opacity: 0.8;
            margin-bottom: 5px;
        }
        
        .summary-amount {
            font-size: 1.3em;
            font-weight: bold;
            color: #fff;
        }
        
        /* íƒ­ ë„¤ë¹„ê²Œì´ì…˜ */
        .nav-tabs {
            display: flex;
            background: #f8f9fa;
            border-radius: 10px;
            padding: 5px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }
        
        .nav-tab {
            flex: 1;
            padding: 15px 20px;
            border: none;
            background: transparent;
            cursor: pointer;
            border-radius: 8px;
            transition: all 0.3s ease;
            font-weight: 500;
            font-size: 0.95em;
            white-space: nowrap;
        }
        
        .nav-tab:hover {
            background: rgba(102, 126, 234, 0.1);
        }
        
        .nav-tab.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
        }
        
        /* íƒ­ ì½˜í…ì¸  */
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
            animation: fadeIn 0.3s ease-in;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* ê³„íš ì„¹ì…˜ */
        .plan-section {
            background: white;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 25px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
        }
        
        .section-title {
            display: flex;
            align-items: center;
            font-size: 1.4em;
            font-weight: bold;
            color: #333;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 3px solid #667eea;
        }
        
        .section-title .icon {
            margin-right: 10px;
            font-size: 1.2em;
        }
        
        /* ì°¨íŠ¸ ê´€ë ¨ ìŠ¤íƒ€ì¼ */
        .charts-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 25px;
            margin-bottom: 25px;
        }
        
        .chart-container {
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
        }
        
        .chart-title {
            font-size: 1.1em;
            font-weight: bold;
            color: #333;
            margin-bottom: 15px;
            text-align: center;
        }
        
        .chart-canvas {
            position: relative;
            height: 300px;
        }
        
        /* ì•Œë¦¼ ë°•ìŠ¤ */
        .alert-box {
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            border-left: 4px solid;
        }
        
        .alert-info {
            background: #d1ecf1;
            color: #0c5460;
            border-left-color: #17a2b8;
        }
        
        .alert-success {
            background: #d4edda;
            color: #155724;
            border-left-color: #28a745;
        }
        
        .alert-warning {
            background: #fff3cd;
            color: #856404;
            border-left-color: #ffc107;
        }
        
        /* ë²„íŠ¼ ìŠ¤íƒ€ì¼ */
        .btn {
            padding: 12px 25px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s ease;
            font-size: 1em;
            position: relative;
        }
        
        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none !important;
        }
        
        .btn-sync {
            background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
            color: white;
        }
        
        .btn-sync:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(40, 167, 69, 0.4);
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #007bff 0%, #6610f2 100%);
            color: white;
        }
        
        .btn-success {
            background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
            color: white;
        }
        
        .btn:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.2);
        }
        
        /* ë¡œë”© ìŠ¤í”¼ë„ˆ */
        .loading-spinner {
            display: none;
            width: 16px;
            height: 16px;
            border: 2px solid transparent;
            border-top: 2px solid currentColor;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-right: 8px;
        }
        
        .btn.loading .loading-spinner {
            display: inline-block;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* ìë™ ì €ì¥ í‘œì‹œê¸° */
        .auto-save-indicator {
            position: fixed;
            top: 20px;
            right: 20px;
            background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
            color: white;
            padding: 10px 20px;
            border-radius: 25px;
            font-size: 0.9em;
            opacity: 0;
            transition: all 0.3s ease;
            z-index: 1000;
        }
        
        .auto-save-indicator.show {
            opacity: 1;
            transform: translateY(0);
        }
        
        /* ìµœì í™” ê·¸ë¦¬ë“œ */
        .optimization-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }
        
        .optimization-card {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border-radius: 15px;
            padding: 20px;
            border-left: 5px solid #667eea;
        }
        
        .optimization-header {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .optimization-icon {
            font-size: 1.5em;
            margin-right: 10px;
        }
        
        .optimization-title {
            font-size: 1.2em;
            font-weight: bold;
            color: #333;
        }
        
        .optimization-content {
            color: #666;
            line-height: 1.6;
        }
        
        /* ë°˜ì‘í˜• ë””ìì¸ */
        @media (max-width: 768px) {
            .container {
                padding: 15px;
            }
            
            .header h1 {
                font-size: 2em;
            }
            
            .charts-row {
                grid-template-columns: 1fr;
            }
            
            .optimization-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <!-- ìë™ ì €ì¥ í‘œì‹œê¸° -->
    <div class="auto-save-indicator" id="autoSaveIndicator">
        ğŸ’¾ ìë™ ì €ì¥ë¨
    </div>

    <div class="container">
        <!-- í—¤ë” êµ¬ì—­ -->
        <div class="header">
            <h1>ğŸ¯ ìŠ¤ë§ˆíŠ¸ íˆ¬ìê³„íš ì‹œìŠ¤í…œ (ë¬´í•œë£¨í”„ ìˆ˜ì •)</h1>
            <p>í˜„ì¬ ìì‚° ë¶„ì„ ê¸°ë°˜ ë§ì¶¤í˜• íˆ¬ìì „ëµ</p>
            <div class="investment-summary">
                <div class="summary-item">
                    <div class="summary-label">í˜„ì¬ ì´ìì‚°</div>
                    <div class="summary-amount" id="currentTotalAssets">-</div>
                </div>
                <div class="summary-item">
                    <div class="summary-label">ì›” íˆ¬ìì—¬ë ¥</div>
                    <div class="summary-amount" id="monthlyInvestment">1,750ë§Œì›</div>
                </div>
                <div class="summary-item">
                    <div class="summary-label">2025ë…„ ëª©í‘œ</div>
                    <div class="summary-amount" id="yearlyTarget">2.1ì–µì›</div>
                </div>
                <div class="summary-item">
                    <div class="summary-label">ëª©í‘œ ìˆ˜ìµë¥ </div>
                    <div class="summary-amount" id="targetReturn">7.5%</div>
                </div>
            </div>
            
            <!-- ë™ê¸°í™” ë²„íŠ¼ ë° ìƒíƒœ í‘œì‹œ -->
            <div style="text-align: center; margin-top: 20px;">
                <button class="btn btn-sync" onclick="ìì‚°ë°ì´í„°ë™ê¸°í™”()" id="syncAssetBtn">
                    <span class="loading-spinner"></span>
                    ğŸ”„ ìì‚° ë°ì´í„° ë™ê¸°í™”
                </button>
                <button class="btn btn-primary" onclick="ëª©í‘œë°°ë¶„ë™ê¸°í™”()" id="syncTargetBtn" style="margin-left: 10px;">
                    <span class="loading-spinner"></span>
                    ğŸ¯ ëª©í‘œë°°ë¶„ ë™ê¸°í™”
                </button>
                <div id="syncStatus" style="margin-top: 10px; font-size: 0.9em; color: #666;"></div>
            </div>
        </div>
        
        <!-- íƒ­ ë„¤ë¹„ê²Œì´ì…˜ -->
        <div class="nav-tabs">
            <button class="nav-tab active" onclick="íƒ­ë³€ê²½('analysis')">ğŸ“Š í˜„ì¬ í¬íŠ¸í´ë¦¬ì˜¤ ë¶„ì„</button>
            <button class="nav-tab" onclick="íƒ­ë³€ê²½('allocation')">ğŸ’¼ 2025ë…„ ê³„ì¢Œë°°ë¶„</button>
            <button class="nav-tab" onclick="íƒ­ë³€ê²½('goals')">ğŸ¯ ëª©í‘œë³„ íˆ¬ìê³„íš</button>
            <button class="nav-tab" onclick="íƒ­ë³€ê²½('simulation')">ğŸ”® íˆ¬ì ì‹œë®¬ë ˆì´ì…˜</button>
            <button class="nav-tab" onclick="íƒ­ë³€ê²½('action')">âš¡ ì•¡ì…˜ í”Œëœ</button>
        </div>
        
        <!-- í˜„ì¬ í¬íŠ¸í´ë¦¬ì˜¤ ë¶„ì„ íƒ­ -->
        <div id="analysis" class="tab-content active">
            <!-- í˜„ì¬ ìì‚° í˜„í™© -->
            <div class="plan-section">
                <div class="section-title">
                    <span class="icon">ğŸ“Š</span>
                    í˜„ì¬ ìì‚° í˜„í™© (assets.html ì—°ë™)
                </div>
                
                <div class="alert-box alert-info">
                    <strong>ğŸ’¡ ì‹¤ì‹œê°„ ì—°ë™:</strong> ìì‚° ê´€ë¦¬ ëª¨ë“ˆì˜ ë°ì´í„°ë¥¼ ì‹¤ì‹œê°„ìœ¼ë¡œ ë¶„ì„í•˜ì—¬ ë§ì¶¤í˜• íˆ¬ì ë°©í–¥ì„ ì œì‹œí•©ë‹ˆë‹¤.<br>
                    <strong>ğŸ”„ ë™ê¸°í™” ê¸°ëŠ¥:</strong> "ìì‚° ë°ì´í„° ë™ê¸°í™”" ë²„íŠ¼ìœ¼ë¡œ ìµœì‹  ìì‚° ë°ì´í„°ë¥¼, "ëª©í‘œë°°ë¶„ ë™ê¸°í™”" ë²„íŠ¼ìœ¼ë¡œ ëª©í‘œ ì„¤ì •ì„ ë™ê¸°í™”í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.<br>
                    <strong>ğŸ¯ ëª©í‘œë°°ë¶„ ë™ê¸°í™”:</strong> assets.htmlì—ì„œ ì„¤ì •í•œ ëª©í‘œ ë°°ë¶„ì´ ìë™ìœ¼ë¡œ ë°˜ì˜ë©ë‹ˆë‹¤.
                </div>
                
                <div class="charts-row">
                    <!-- í˜„ì¬ ìì‚° ë°°ë¶„ -->
                    <div class="chart-container">
                        <div class="chart-title">í˜„ì¬ ìì‚° ë°°ë¶„</div>
                        <div class="chart-canvas">
                            <canvas id="currentAssetChart"></canvas>
                        </div>
                    </div>
                    
                    <!-- ëª©í‘œ vs í˜„ì¬ ë¹„êµ -->
                    <div class="chart-container">
                        <div class="chart-title">ëª©í‘œ vs í˜„ì¬ ìì‚°ë°°ë¶„ ë¹„êµ</div>
                        <div class="chart-canvas">
                            <canvas id="targetVsCurrentChart"></canvas>
                        </div>
                    </div>
                </div>
                
                <!-- ë™ê¸°í™” ìƒíƒœ í‘œì‹œ -->
                <div style="background: white; padding: 20px; border-radius: 10px; margin-bottom: 20px;">
                    <h3 style="color: #007bff; margin-bottom: 15px;">ğŸ”„ ë™ê¸°í™” ìƒíƒœ</h3>
                    <div id="syncStatusDetail">
                        <!-- ë™ê¸°í™” ìƒíƒœê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤ -->
                    </div>
                </div>
                
                <!-- ìì‚°ë³„ ìƒì„¸ ë‚´ì—­ -->
                <div style="background: white; padding: 20px; border-radius: 10px;">
                    <h3 style="color: #007bff; margin-bottom: 15px;">ğŸ’° í˜„ì¬ ë³´ìœ  ìì‚° ìƒì„¸</h3>
                    <div id="currentAssetsList">
                        <!-- í˜„ì¬ ìì‚° ëª©ë¡ì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤ -->
                    </div>
                </div>
            </div>
            
            <!-- í¬íŠ¸í´ë¦¬ì˜¤ ë¶„ì„ ê²°ê³¼ -->
            <div class="plan-section">
                <div class="section-title">
                    <span class="icon">ğŸ”</span>
                    í¬íŠ¸í´ë¦¬ì˜¤ ë¶„ì„ ê²°ê³¼
                </div>
                
                <div id="portfolioAnalysis" class="optimization-grid">
                    <!-- ë¶„ì„ ê²°ê³¼ê°€ ì—¬ê¸°ì— ë™ì ìœ¼ë¡œ í‘œì‹œë©ë‹ˆë‹¤ -->
                </div>
            </div>
        </div>
        
        <!-- ë‚˜ë¨¸ì§€ íƒ­ë“¤ (ê°„ë‹¨í™”) -->
        <div id="allocation" class="tab-content">
            <div class="plan-section">
                <div class="section-title">
                    <span class="icon">ğŸ’¼</span>
                    2025ë…„ ê³„ì¢Œë°°ë¶„
                </div>
                <p>ê³„ì¢Œë³„ ìì‚° ë°°ë¶„ ê³„íšì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤...</p>
            </div>
        </div>
        
        <div id="goals" class="tab-content">
            <div class="plan-section">
                <div class="section-title">
                    <span class="icon">ğŸ¯</span>
                    ëª©í‘œë³„ íˆ¬ìê³„íš
                </div>
                <p>íˆ¬ì ëª©í‘œë³„ ì„¸ë¶€ ê³„íšì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤...</p>
            </div>
        </div>
        
        <div id="simulation" class="tab-content">
            <div class="plan-section">
                <div class="section-title">
                    <span class="icon">ğŸ”®</span>
                    íˆ¬ì ì‹œë®¬ë ˆì´ì…˜
                </div>
                <p>íˆ¬ì ì‹œë®¬ë ˆì´ì…˜ ê²°ê³¼ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤...</p>
            </div>
        </div>
        
        <div id="action" class="tab-content">
            <div class="plan-section">
                <div class="section-title">
                    <span class="icon">âš¡</span>
                    ì•¡ì…˜ í”Œëœ
                </div>
                <p>ì‹¤í–‰ ê°€ëŠ¥í•œ íˆ¬ì ì•¡ì…˜ í”Œëœì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤...</p>
            </div>
        </div>
    </div>

    <script>
        /*
        ===========================================
        â˜… ë¬´í•œë£¨í”„ ë°©ì§€ ì‹œìŠ¤í…œ (í•µì‹¬ ìˆ˜ì •)
        ===========================================
        */
        
        // â˜… ì¤‘ë³µ ì‹¤í–‰ ë°©ì§€ í”Œë˜ê·¸ë“¤
        let ìì‚°ë™ê¸°í™”ì¤‘ = false;
        let ëª©í‘œë°°ë¶„ë™ê¸°í™”ì¤‘ = false;
        let ì°¨íŠ¸ì—…ë°ì´íŠ¸ì¤‘ = false;
        let ìë™ì €ì¥ì¤‘ = false;
        let ì €ì¥ì†Œê°ì§€ì¤‘ë‹¨ = false;
        
        // â˜… ë””ë°”ìš´ìŠ¤ íƒ€ì´ë¨¸ë“¤
        let ìì‚°ë™ê¸°í™”íƒ€ì´ë¨¸ = null;
        let ëª©í‘œë°°ë¶„ë™ê¸°í™”íƒ€ì´ë¨¸ = null;
        let ì°¨íŠ¸ì—…ë°ì´íŠ¸íƒ€ì´ë¨¸ = null;
        let ìë™ì €ì¥íƒ€ì´ë¨¸ = null;
        
        // â˜… ë§ˆì§€ë§‰ ì €ì¥ ì‹œê°„ ê¸°ë¡ (ì¤‘ë³µ ì €ì¥ ë°©ì§€)
        let ë§ˆì§€ë§‰ìì‚°ì €ì¥ì‹œê°„ = 0;
        let ë§ˆì§€ë§‰ëª©í‘œë°°ë¶„ì €ì¥ì‹œê°„ = 0;
        
        /*
        ===========================================
        ì „ì—­ ë³€ìˆ˜ ë° ë°ì´í„° êµ¬ì¡°
        ===========================================
        */
        
        const STORAGE_KEYS = {
            ìì‚°ë°ì´í„°: 'shared_asset_data',
            ëª©í‘œë°°ë¶„: 'shared_target_allocation',
            íˆ¬ìê³„íš: 'module3_investment_plan',
            íˆ¬ìëª©í‘œ: 'module3_investment_goals',
            íˆ¬ìì„¤ì •: 'module3_settings'
        };
        
        let í˜„ì¬ìì‚°ë°ì´í„° = null;
        
        let íˆ¬ìì„¤ì • = {
            ì›”íˆ¬ìì—¬ë ¥: 1750,
            ì—°íˆ¬ìì—¬ë ¥: 21000,
            ëª©í‘œìˆ˜ìµë¥ : 7.5,
            íˆ¬ìê¸°ê°„: 10,
            ìœ„í—˜ì„±í–¥: 'ê· í˜•í˜•'
        };
        
        let ëª©í‘œë°°ë¶„ = {
            'êµ­ë‚´ì£¼ì‹': 25.0,
            'í•´ì™¸ì£¼ì‹': 30.0,
            'ì±„ê¶Œ': 20.0,
            'ë¶€ë™ì‚°': 15.0,
            'í˜„ê¸ˆ': 5.0,
            'ëŒ€ì•ˆíˆ¬ì': 5.0 
        };
        
        let íˆ¬ìëª©í‘œëª©ë¡ = [];
        let í˜„ì¬ìì‚°ì°¨íŠ¸ = null;
        let ëª©í‘œëŒ€ë¹„ì°¨íŠ¸ = null;
        
        const ì°¨íŠ¸ìƒ‰ìƒ = [
            '#FF6384', '#36A2EB', '#FFCE56', '#4BC0C0', 
            '#9966FF', '#FF9F40', '#FF6384', '#C9CBCF', '#E7E9ED'
        ];
        
        /*
        ===========================================
        â˜… ì™„ì „íˆ ìˆ˜ì •ëœ ë™ê¸°í™” í•¨ìˆ˜ë“¤ (ë¬´í•œë£¨í”„ ë°©ì§€)
        ===========================================
        */
        
        // â˜… ë²„íŠ¼ ìƒíƒœ ê´€ë¦¬ í•¨ìˆ˜
        function ë²„íŠ¼ë¡œë”©ìƒíƒœ(ë²„íŠ¼Id, ë¡œë”©ìƒíƒœ) {
            const ë²„íŠ¼ = document.getElementById(ë²„íŠ¼Id);
            if (ë²„íŠ¼) {
                if (ë¡œë”©ìƒíƒœ) {
                    ë²„íŠ¼.classList.add('loading');
                    ë²„íŠ¼.disabled = true;
                } else {
                    ë²„íŠ¼.classList.remove('loading');
                    ë²„íŠ¼.disabled = false;
                }
            }
        }
        
        // â˜… ë””ë°”ìš´ìŠ¤ í•¨ìˆ˜ (ì—°ì† í˜¸ì¶œ ë°©ì§€)
        function ë””ë°”ìš´ìŠ¤(í•¨ìˆ˜, ì§€ì—°ì‹œê°„) {
            let íƒ€ì´ë¨¸;
            return function(...args) {
                clearTimeout(íƒ€ì´ë¨¸);
                íƒ€ì´ë¨¸ = setTimeout(() => í•¨ìˆ˜.apply(this, args), ì§€ì—°ì‹œê°„);
            };
        }
        
        // â˜… ì™„ì „íˆ ìˆ˜ì •ëœ ëª©í‘œë°°ë¶„ ë™ê¸°í™” í•¨ìˆ˜
        function ëª©í‘œë°°ë¶„ë™ê¸°í™”() {
            // ì¤‘ë³µ ì‹¤í–‰ ë°©ì§€
            if (ëª©í‘œë°°ë¶„ë™ê¸°í™”ì¤‘) {
                console.log('âš ï¸ ëª©í‘œë°°ë¶„ ë™ê¸°í™”ê°€ ì´ë¯¸ ì§„í–‰ ì¤‘ì…ë‹ˆë‹¤.');
                return false;
            }
            
            // ë””ë°”ìš´ìŠ¤ íƒ€ì´ë¨¸ ì„¤ì •
            if (ëª©í‘œë°°ë¶„ë™ê¸°í™”íƒ€ì´ë¨¸) {
                clearTimeout(ëª©í‘œë°°ë¶„ë™ê¸°í™”íƒ€ì´ë¨¸);
            }
            
            ëª©í‘œë°°ë¶„ë™ê¸°í™”íƒ€ì´ë¨¸ = setTimeout(() => {
                ì‹¤ì œëª©í‘œë°°ë¶„ë™ê¸°í™”();
            }, 300); // 300ms ì§€ì—°
        }
        
        function ì‹¤ì œëª©í‘œë°°ë¶„ë™ê¸°í™”() {
            try {
                ëª©í‘œë°°ë¶„ë™ê¸°í™”ì¤‘ = true;
                ë²„íŠ¼ë¡œë”©ìƒíƒœ('syncTargetBtn', true);
                
                const ìƒíƒœí‘œì‹œ = document.getElementById('syncStatus');
                ìƒíƒœí‘œì‹œ.textContent = 'ğŸ”„ ëª©í‘œë°°ë¶„ ë™ê¸°í™” ì¤‘...';
                ìƒíƒœí‘œì‹œ.style.color = '#007bff';
                
                console.log('ğŸ¯ ëª©í‘œë°°ë¶„ ë™ê¸°í™” ì‹œì‘');
                
                const assetsëª¨ë“ˆëª©í‘œë°°ë¶„ = localStorage.getItem(STORAGE_KEYS.ëª©í‘œë°°ë¶„);
                
                if (!assetsëª¨ë“ˆëª©í‘œë°°ë¶„) {
                    throw new Error('ëª©í‘œë°°ë¶„ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.');
                }
                
                const íŒŒì‹±ëœëª©í‘œë°°ë¶„ = JSON.parse(assetsëª¨ë“ˆëª©í‘œë°°ë¶„);
                console.log('ğŸ“Š íŒŒì‹±ëœ ëª©í‘œë°°ë¶„ ë°ì´í„°:', íŒŒì‹±ëœëª©í‘œë°°ë¶„);
                
                // â˜… ë°ì´í„° í˜•ì‹ ì²˜ë¦¬ (ì—¬ëŸ¬ í˜•ì‹ ëŒ€ì‘)
                let ìƒˆëª©í‘œë°°ë¶„ = null;
                
                if (íŒŒì‹±ëœëª©í‘œë°°ë¶„.ëª©í‘œë°°ë¶„ && typeof íŒŒì‹±ëœëª©í‘œë°°ë¶„.ëª©í‘œë°°ë¶„ === 'object') {
                    ìƒˆëª©í‘œë°°ë¶„ = íŒŒì‹±ëœëª©í‘œë°°ë¶„.ëª©í‘œë°°ë¶„;
                } else if (typeof íŒŒì‹±ëœëª©í‘œë°°ë¶„ === 'object' && íŒŒì‹±ëœëª©í‘œë°°ë¶„.êµ­ë‚´ì£¼ì‹ !== undefined) {
                    ìƒˆëª©í‘œë°°ë¶„ = íŒŒì‹±ëœëª©í‘œë°°ë¶„;
                } else if (íŒŒì‹±ëœëª©í‘œë°°ë¶„.data && typeof íŒŒì‹±ëœëª©í‘œë°°ë¶„.data === 'object') {
                    ìƒˆëª©í‘œë°°ë¶„ = íŒŒì‹±ëœëª©í‘œë°°ë¶„.data;
                }
                
                if (!ìƒˆëª©í‘œë°°ë¶„) {
                    throw new Error('ëª©í‘œë°°ë¶„ ë°ì´í„° í˜•ì‹ì„ ì¸ì‹í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                }
                
                // â˜… í•„ìˆ˜ í•„ë“œ ê²€ì¦
                const í•„ìˆ˜í•„ë“œ = ['êµ­ë‚´ì£¼ì‹', 'í•´ì™¸ì£¼ì‹', 'ì±„ê¶Œ', 'ë¶€ë™ì‚°', 'í˜„ê¸ˆ'];
                const ëˆ„ë½í•„ë“œ = í•„ìˆ˜í•„ë“œ.filter(í•„ë“œ => ìƒˆëª©í‘œë°°ë¶„[í•„ë“œ] === undefined);
                
                if (ëˆ„ë½í•„ë“œ.length > 0) {
                    throw new Error(`í•„ìˆ˜ í•„ë“œ ëˆ„ë½: ${ëˆ„ë½í•„ë“œ.join(', ')}`);
                }
                
                // â˜… ìˆ«ì ë°ì´í„° ê²€ì¦ ë° ë³€í™˜
                const ê²€ì¦ëœëª©í‘œë°°ë¶„ = {};
                for (const [í‚¤, ê°’] of Object.entries(ìƒˆëª©í‘œë°°ë¶„)) {
                    const ìˆ«ìê°’ = parseFloat(ê°’);
                    if (isNaN(ìˆ«ìê°’) || ìˆ«ìê°’ < 0 || ìˆ«ìê°’ > 100) {
                        throw new Error(`ì˜ëª»ëœ ë¹„ìœ¨ ê°’: ${í‚¤} = ${ê°’}`);
                    }
                    ê²€ì¦ëœëª©í‘œë°°ë¶„[í‚¤] = ìˆ«ìê°’;
                }
                
                // â˜… ëª©í‘œë°°ë¶„ ì ìš© (ì €ì¥ì†Œ ê°ì§€ ì¤‘ë‹¨)
                ì €ì¥ì†Œê°ì§€ì¤‘ë‹¨ = true;
                ëª©í‘œë°°ë¶„ = { ...ê²€ì¦ëœëª©í‘œë°°ë¶„ };
                
                ìƒíƒœí‘œì‹œ.textContent = 'âœ… ëª©í‘œë°°ë¶„ ë™ê¸°í™” ì™„ë£Œ!';
                ìƒíƒœí‘œì‹œ.style.color = '#28a745';
                
                console.log('âœ… ëª©í‘œë°°ë¶„ ë™ê¸°í™” ì„±ê³µ:', ëª©í‘œë°°ë¶„);
                
                // â˜… ì•ˆì „í•œ UI ì—…ë°ì´íŠ¸ (ë””ë°”ìš´ìŠ¤ ì ìš©)
                ë””ë°”ìš´ìŠ¤ëœì°¨íŠ¸ì—…ë°ì´íŠ¸();
                ë””ë°”ìš´ìŠ¤ëœë™ê¸°í™”ìƒíƒœí‘œì‹œ();
                
                // â˜… ì•ˆì „í•œ ìë™ ì €ì¥ (í”Œë˜ê·¸ ì²´í¬)
                setTimeout(() => {
                    if (!ìë™ì €ì¥ì¤‘) {
                        ì•ˆì „í•œìë™ì €ì¥('ëª©í‘œë°°ë¶„');
                    }
                }, 500);
                
                return true;
                
            } catch (error) {
                console.error('âŒ ëª©í‘œë°°ë¶„ ë™ê¸°í™” ì‹¤íŒ¨:', error);
                const ìƒíƒœí‘œì‹œ = document.getElementById('syncStatus');
                ìƒíƒœí‘œì‹œ.textContent = `âŒ ë™ê¸°í™” ì‹¤íŒ¨: ${error.message}`;
                ìƒíƒœí‘œì‹œ.style.color = '#dc3545';
                return false;
                
            } finally {
                ëª©í‘œë°°ë¶„ë™ê¸°í™”ì¤‘ = false;
                ë²„íŠ¼ë¡œë”©ìƒíƒœ('syncTargetBtn', false);
                ì €ì¥ì†Œê°ì§€ì¤‘ë‹¨ = false;
                
                // 3ì´ˆ í›„ ìƒíƒœ ë©”ì‹œì§€ ì§€ìš°ê¸°
                setTimeout(() => {
                    const ìƒíƒœí‘œì‹œ = document.getElementById('syncStatus');
                    if (ìƒíƒœí‘œì‹œ && ìƒíƒœí‘œì‹œ.textContent.includes('ëª©í‘œë°°ë¶„')) {
                        ìƒíƒœí‘œì‹œ.textContent = '';
                    }
                }, 3000);
            }
        }
        
        // â˜… ì™„ì „íˆ ìˆ˜ì •ëœ ìì‚°ë°ì´í„° ë™ê¸°í™” í•¨ìˆ˜
        function ìì‚°ë°ì´í„°ë™ê¸°í™”() {
            // ì¤‘ë³µ ì‹¤í–‰ ë°©ì§€
            if (ìì‚°ë™ê¸°í™”ì¤‘) {
                console.log('âš ï¸ ìì‚°ë°ì´í„° ë™ê¸°í™”ê°€ ì´ë¯¸ ì§„í–‰ ì¤‘ì…ë‹ˆë‹¤.');
                return false;
            }
            
            // ë””ë°”ìš´ìŠ¤ íƒ€ì´ë¨¸ ì„¤ì •
            if (ìì‚°ë™ê¸°í™”íƒ€ì´ë¨¸) {
                clearTimeout(ìì‚°ë™ê¸°í™”íƒ€ì´ë¨¸);
            }
            
            ìì‚°ë™ê¸°í™”íƒ€ì´ë¨¸ = setTimeout(() => {
                ì‹¤ì œìì‚°ë°ì´í„°ë™ê¸°í™”();
            }, 300); // 300ms ì§€ì—°
        }
        
        function ì‹¤ì œìì‚°ë°ì´í„°ë™ê¸°í™”() {
            try {
                ìì‚°ë™ê¸°í™”ì¤‘ = true;
                ë²„íŠ¼ë¡œë”©ìƒíƒœ('syncAssetBtn', true);
                
                const ìƒíƒœí‘œì‹œ = document.getElementById('syncStatus');
                ìƒíƒœí‘œì‹œ.textContent = 'ğŸ”„ ìì‚°ë°ì´í„° ë™ê¸°í™” ì¤‘...';
                ìƒíƒœí‘œì‹œ.style.color = '#007bff';
                
                const assetsëª¨ë“ˆë°ì´í„° = localStorage.getItem(STORAGE_KEYS.ìì‚°ë°ì´í„°);
                
                if (assetsëª¨ë“ˆë°ì´í„°) {
                    const íŒŒì‹±ëœë°ì´í„° = JSON.parse(assetsëª¨ë“ˆë°ì´í„°);
                    í˜„ì¬ìì‚°ë°ì´í„° = íŒŒì‹±ëœë°ì´í„°;
                    
                    ìƒíƒœí‘œì‹œ.textContent = 'âœ… ìì‚°ë°ì´í„° ë™ê¸°í™” ì™„ë£Œ!';
                    ìƒíƒœí‘œì‹œ.style.color = '#28a745';
                    
                    console.log('âœ… ìì‚°ë°ì´í„° ë™ê¸°í™” ì™„ë£Œ');
                } else {
                    ìƒíƒœí‘œì‹œ.textContent = 'âš ï¸ assets.html ë°ì´í„° ì—†ìŒ';
                    ìƒíƒœí‘œì‹œ.style.color = '#ffc107';
                    
                    í˜„ì¬ìì‚°ë°ì´í„° = ê¸°ë³¸í…ŒìŠ¤íŠ¸ë°ì´í„°ìƒì„±();
                }
                
                // â˜… ì•ˆì „í•œ UI ì—…ë°ì´íŠ¸
                ë””ë°”ìš´ìŠ¤ëœì°¨íŠ¸ì—…ë°ì´íŠ¸();
                ë””ë°”ìš´ìŠ¤ëœë™ê¸°í™”ìƒíƒœí‘œì‹œ();
                
                return true;
                
            } catch (error) {
                console.error('âŒ ìì‚°ë°ì´í„° ë™ê¸°í™” ì‹¤íŒ¨:', error);
                const ìƒíƒœí‘œì‹œ = document.getElementById('syncStatus');
                ìƒíƒœí‘œì‹œ.textContent = 'âŒ ë™ê¸°í™” ì‹¤íŒ¨';
                ìƒíƒœí‘œì‹œ.style.color = '#dc3545';
                return false;
                
            } finally {
                ìì‚°ë™ê¸°í™”ì¤‘ = false;
                ë²„íŠ¼ë¡œë”©ìƒíƒœ('syncAssetBtn', false);
                
                // 3ì´ˆ í›„ ìƒíƒœ ë©”ì‹œì§€ ì§€ìš°ê¸°
                setTimeout(() => {
                    const ìƒíƒœí‘œì‹œ = document.getElementById('syncStatus');
                    if (ìƒíƒœí‘œì‹œ && ìƒíƒœí‘œì‹œ.textContent.includes('ìì‚°ë°ì´í„°')) {
                        ìƒíƒœí‘œì‹œ.textContent = '';
                    }
                }, 3000);
            }
        }
        
        /*
        ===========================================
        â˜… ì•ˆì „í•œ ì—…ë°ì´íŠ¸ í•¨ìˆ˜ë“¤ (ë””ë°”ìš´ìŠ¤ ì ìš©)
        ===========================================
        */
        
        // â˜… ë””ë°”ìš´ìŠ¤ëœ ì°¨íŠ¸ ì—…ë°ì´íŠ¸
        const ë””ë°”ìš´ìŠ¤ëœì°¨íŠ¸ì—…ë°ì´íŠ¸ = ë””ë°”ìš´ìŠ¤(() => {
            if (ì°¨íŠ¸ì—…ë°ì´íŠ¸ì¤‘) return;
            
            ì°¨íŠ¸ì—…ë°ì´íŠ¸ì¤‘ = true;
            try {
                ì•ˆì „í•œì°¨íŠ¸ì—…ë°ì´íŠ¸();
            } finally {
                ì°¨íŠ¸ì—…ë°ì´íŠ¸ì¤‘ = false;
            }
        }, 500);
        
        // â˜… ë””ë°”ìš´ìŠ¤ëœ ë™ê¸°í™” ìƒíƒœ í‘œì‹œ
        const ë””ë°”ìš´ìŠ¤ëœë™ê¸°í™”ìƒíƒœí‘œì‹œ = ë””ë°”ìš´ìŠ¤(() => {
            ë™ê¸°í™”ìƒíƒœí‘œì‹œ();
        }, 300);
        
        // â˜… ì•ˆì „í•œ ì°¨íŠ¸ ì—…ë°ì´íŠ¸
        function ì•ˆì „í•œì°¨íŠ¸ì—…ë°ì´íŠ¸() {
            try {
                // ì´ìì‚° í‘œì‹œ ì—…ë°ì´íŠ¸
                if (í˜„ì¬ìì‚°ë°ì´í„°) {
                    const ì´ì•¡ = Object.values(í˜„ì¬ìì‚°ë°ì´í„°.ìœ í˜•ë³„í•©ê³„ || {}).reduce((sum, val) => sum + val, 0);
                    const ì´ìì‚°ìš”ì†Œ = document.getElementById('currentTotalAssets');
                    if (ì´ìì‚°ìš”ì†Œ) {
                        ì´ìì‚°ìš”ì†Œ.textContent = `${ì´ì•¡.toLocaleString()}ë§Œì›`;
                    }
                }
                
                // ì°¨íŠ¸ ì—…ë°ì´íŠ¸ (ì•ˆì „í•˜ê²Œ)
                í˜„ì¬ìì‚°ë°°ë¶„ì°¨íŠ¸ìƒì„±();
                ëª©í‘œëŒ€ë¹„ë¹„êµì°¨íŠ¸ìƒì„±();
                í¬íŠ¸í´ë¦¬ì˜¤ë¶„ì„ìƒì„±();
                í˜„ì¬ìì‚°ëª©ë¡í‘œì‹œ();
                
            } catch (error) {
                console.error('ì°¨íŠ¸ ì—…ë°ì´íŠ¸ ì˜¤ë¥˜:', error);
            }
        }
        
        /*
        ===========================================
        â˜… ì•ˆì „í•œ ìë™ ì €ì¥ ì‹œìŠ¤í…œ
        ===========================================
        */
        
        function ì•ˆì „í•œìë™ì €ì¥(íƒ€ì… = 'ì¼ë°˜') {
            // ì¤‘ë³µ ì €ì¥ ë°©ì§€
            if (ìë™ì €ì¥ì¤‘) {
                console.log('âš ï¸ ìë™ì €ì¥ì´ ì´ë¯¸ ì§„í–‰ ì¤‘ì…ë‹ˆë‹¤.');
                return false;
            }
            
            // ë„ˆë¬´ ë¹ˆë²ˆí•œ ì €ì¥ ë°©ì§€ (1ì´ˆ ì´ë‚´ ì¤‘ë³µ ì €ì¥ ì°¨ë‹¨)
            const í˜„ì¬ì‹œê°„ = Date.now();
            if (íƒ€ì… === 'ëª©í‘œë°°ë¶„' && í˜„ì¬ì‹œê°„ - ë§ˆì§€ë§‰ëª©í‘œë°°ë¶„ì €ì¥ì‹œê°„ < 1000) {
                console.log('âš ï¸ ëª©í‘œë°°ë¶„ ì €ì¥ ì£¼ê¸°ê°€ ë„ˆë¬´ ì§§ìŠµë‹ˆë‹¤.');
                return false;
            }
            if (íƒ€ì… === 'ìì‚°' && í˜„ì¬ì‹œê°„ - ë§ˆì§€ë§‰ìì‚°ì €ì¥ì‹œê°„ < 1000) {
                console.log('âš ï¸ ìì‚° ì €ì¥ ì£¼ê¸°ê°€ ë„ˆë¬´ ì§§ìŠµë‹ˆë‹¤.');
                return false;
            }
            
            try {
                ìë™ì €ì¥ì¤‘ = true;
                ì €ì¥ì†Œê°ì§€ì¤‘ë‹¨ = true; // ì €ì¥ ì¤‘ ê°ì§€ ì¤‘ë‹¨
                
                const ì €ì¥ë°ì´í„° = {
                    íˆ¬ìì„¤ì •: íˆ¬ìì„¤ì •,
                    ëª©í‘œë°°ë¶„: ëª©í‘œë°°ë¶„,
                    íˆ¬ìëª©í‘œëª©ë¡: íˆ¬ìëª©í‘œëª©ë¡,
                    ë§ˆì§€ë§‰ì—…ë°ì´íŠ¸: new Date().toISOString(),
                    ë²„ì „: 'v2.2_fixed'
                };
                
                localStorage.setItem(STORAGE_KEYS.íˆ¬ìê³„íš, JSON.stringify(ì €ì¥ë°ì´í„°));
                
                // ëª©í‘œë°°ë¶„ ë³„ë„ ì €ì¥ (íƒ€ì…ì´ ëª©í‘œë°°ë¶„ì¸ ê²½ìš°ë§Œ)
                if (íƒ€ì… === 'ëª©í‘œë°°ë¶„') {
                    const ëª©í‘œë°°ë¶„ë°ì´í„° = {
                        ëª©í‘œë°°ë¶„: ëª©í‘œë°°ë¶„,
                        ë§ˆì§€ë§‰ì—…ë°ì´íŠ¸: new Date().toISOString(),
                        ì—…ë°ì´íŠ¸ì†ŒìŠ¤: 'investment_planner'
                    };
                    localStorage.setItem(STORAGE_KEYS.ëª©í‘œë°°ë¶„, JSON.stringify(ëª©í‘œë°°ë¶„ë°ì´í„°));
                    ë§ˆì§€ë§‰ëª©í‘œë°°ë¶„ì €ì¥ì‹œê°„ = í˜„ì¬ì‹œê°„;
                } else {
                    ë§ˆì§€ë§‰ìì‚°ì €ì¥ì‹œê°„ = í˜„ì¬ì‹œê°„;
                }
                
                ìë™ì €ì¥í‘œì‹œ();
                console.log(`âœ… ${íƒ€ì…} ìë™ì €ì¥ ì™„ë£Œ`);
                
                return true;
                
            } catch (error) {
                console.error('ìë™ì €ì¥ ì˜¤ë¥˜:', error);
                return false;
            } finally {
                ìë™ì €ì¥ì¤‘ = false;
                setTimeout(() => {
                    ì €ì¥ì†Œê°ì§€ì¤‘ë‹¨ = false;
                }, 1000); // 1ì´ˆ í›„ ê°ì§€ ì¬ê°œ
            }
        }
        
        /*
        ===========================================
        ìë™ ë¶ˆëŸ¬ì˜¤ê¸° ë° ê¸°íƒ€ í•¨ìˆ˜ë“¤
        ===========================================
        */
        
        function ìë™ë¶ˆëŸ¬ì˜¤ê¸°() {
            try {
                console.log('ğŸ“‚ ìë™ ë¶ˆëŸ¬ì˜¤ê¸° ì‹œì‘');
                
                const ì €ì¥ëœíˆ¬ìê³„íš = localStorage.getItem(STORAGE_KEYS.íˆ¬ìê³„íš);
                if (ì €ì¥ëœíˆ¬ìê³„íš) {
                    const íŒŒì‹±ëœë°ì´í„° = JSON.parse(ì €ì¥ëœíˆ¬ìê³„íš);
                    
                    if (íŒŒì‹±ëœë°ì´í„°.íˆ¬ìì„¤ì •) {
                        íˆ¬ìì„¤ì • = { ...íˆ¬ìì„¤ì •, ...íŒŒì‹±ëœë°ì´í„°.íˆ¬ìì„¤ì • };
                    }
                    
                    if (íŒŒì‹±ëœë°ì´í„°.íˆ¬ìëª©í‘œëª©ë¡) {
                        íˆ¬ìëª©í‘œëª©ë¡ = [...íŒŒì‹±ëœë°ì´í„°.íˆ¬ìëª©í‘œëª©ë¡];
                    }
                    
                    // ëª©í‘œë°°ë¶„ ë¡œë“œ
                    const ê³µìœ ëª©í‘œë°°ë¶„ = localStorage.getItem(STORAGE_KEYS.ëª©í‘œë°°ë¶„);
                    if (ê³µìœ ëª©í‘œë°°ë¶„) {
                        try {
                            const íŒŒì‹±ëœëª©í‘œë°°ë¶„ = JSON.parse(ê³µìœ ëª©í‘œë°°ë¶„);
                            if (íŒŒì‹±ëœëª©í‘œë°°ë¶„.ëª©í‘œë°°ë¶„) {
                                ëª©í‘œë°°ë¶„ = { ...ëª©í‘œë°°ë¶„, ...íŒŒì‹±ëœëª©í‘œë°°ë¶„.ëª©í‘œë°°ë¶„ };
                            }
                        } catch (e) {
                            console.error('ëª©í‘œë°°ë¶„ íŒŒì‹± ì˜¤ë¥˜:', e);
                        }
                    }
                }
                
                // ìì‚° ë°ì´í„° ë¡œë“œ
                setTimeout(() => {
                    if (!ìì‚°ë™ê¸°í™”ì¤‘) {
                        ìì‚°ë°ì´í„°ë™ê¸°í™”();
                    }
                }, 100);
                
            } catch (error) {
                console.error('ìë™ë¶ˆëŸ¬ì˜¤ê¸° ì˜¤ë¥˜:', error);
            }
        }
        
        function ìë™ì €ì¥í‘œì‹œ() {
            const í‘œì‹œê¸° = document.getElementById('autoSaveIndicator');
            if (í‘œì‹œê¸°) {
                í‘œì‹œê¸°.classList.add('show');
                setTimeout(() => {
                    í‘œì‹œê¸°.classList.remove('show');
                }, 2000);
            }
        }
        
        function ë™ê¸°í™”ìƒíƒœí‘œì‹œ() {
            const ìƒì„¸í‘œì‹œì˜ì—­ = document.getElementById('syncStatusDetail');
            if (!ìƒì„¸í‘œì‹œì˜ì—­) return;
            
            const í˜„ì¬ì‹œê°„ = new Date().toLocaleString('ko-KR');
            
            let ìì‚°ë™ê¸°í™”ìƒíƒœ = í˜„ì¬ìì‚°ë°ì´í„° ? 'âœ… ë™ê¸°í™”ë¨' : 'âŒ ë¯¸ë™ê¸°í™”';
            let ëª©í‘œë°°ë¶„ë™ê¸°í™”ìƒíƒœ = 'âŒ ë¯¸ë™ê¸°í™”';
            
            const assetsëª©í‘œë°°ë¶„ = localStorage.getItem(STORAGE_KEYS.ëª©í‘œë°°ë¶„);
            if (assetsëª©í‘œë°°ë¶„) {
                try {
                    const íŒŒì‹±ëœëª©í‘œë°°ë¶„ = JSON.parse(assetsëª©í‘œë°°ë¶„);
                    if (íŒŒì‹±ëœëª©í‘œë°°ë¶„.ëª©í‘œë°°ë¶„ || íŒŒì‹±ëœëª©í‘œë°°ë¶„.êµ­ë‚´ì£¼ì‹) {
                        ëª©í‘œë°°ë¶„ë™ê¸°í™”ìƒíƒœ = 'âœ… ë™ê¸°í™”ë¨';
                    }
                } catch (e) {
                    ëª©í‘œë°°ë¶„ë™ê¸°í™”ìƒíƒœ = 'âš ï¸ ë°ì´í„° ì˜¤ë¥˜';
                }
            }
            
            ìƒì„¸í‘œì‹œì˜ì—­.innerHTML = `
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px;">
                    <div style="background: #f8f9fa; padding: 15px; border-radius: 8px; border-left: 4px solid #007bff;">
                        <strong>ğŸ“Š ìì‚° ë°ì´í„°</strong><br>
                        ìƒíƒœ: ${ìì‚°ë™ê¸°í™”ìƒíƒœ}<br>
                        <small style="color: #666;">ë§ˆì§€ë§‰ í™•ì¸: ${í˜„ì¬ì‹œê°„}</small>
                    </div>
                    <div style="background: #f8f9fa; padding: 15px; border-radius: 8px; border-left: 4px solid #28a745;">
                        <strong>ğŸ¯ ëª©í‘œ ë°°ë¶„</strong><br>
                        ìƒíƒœ: ${ëª©í‘œë°°ë¶„ë™ê¸°í™”ìƒíƒœ}<br>
                        <small style="color: #666;">ë§ˆì§€ë§‰ í™•ì¸: ${í˜„ì¬ì‹œê°„}</small>
                    </div>
                    <div style="background: #f8f9fa; padding: 15px; border-radius: 8px; border-left: 4px solid #ffc107;">
                        <strong>ğŸ”„ ë¬´í•œë£¨í”„ ë°©ì§€</strong><br>
                        ìƒíƒœ: âœ… í™œì„±í™”<br>
                        <small style="color: #666;">ë””ë°”ìš´ìŠ¤ ë° í”Œë˜ê·¸ ì‹œìŠ¤í…œ ì ìš©</small>
                    </div>
                </div>
            `;
        }
        
        /*
        ===========================================
        ê¸°ë³¸ í…ŒìŠ¤íŠ¸ ë°ì´í„° ë° ì°¨íŠ¸ í•¨ìˆ˜ë“¤
        ===========================================
        */
        
        function ê¸°ë³¸í…ŒìŠ¤íŠ¸ë°ì´í„°ìƒì„±() {
            return {
                í˜„ì¬ìì‚°: {
                    'ì‚¼ì„±ì „ì': { ìœ í˜•: 'êµ­ë‚´ ê°œë³„ì£¼ì‹', ê³„ì¢Œ: 'ì‚¼ì„±ì¦ê¶Œ', ë§¤ì…ê°€: 5000, í˜„ì¬ê°€: 5500 },
                    'KODEX 200': { ìœ í˜•: 'êµ­ë‚´ ETF', ê³„ì¢Œ: 'ì‚¼ì„±ì¦ê¶Œ', ë§¤ì…ê°€: 3000, í˜„ì¬ê°€: 3200 },
                    'VTI': { ìœ í˜•: 'í•´ì™¸ ETF', ê³„ì¢Œ: 'ë¯¸ë˜ì—ì…‹', ë§¤ì…ê°€: 2000, í˜„ì¬ê°€: 2100 },
                    'êµ­ê³ ì±„ 3ë…„': { ìœ í˜•: 'êµ­ë‚´ì±„ê¶Œ', ê³„ì¢Œ: 'í•˜ë‚˜ì€í–‰', ë§¤ì…ê°€: 1000, í˜„ì¬ê°€: 1020 },
                    'ì˜ˆê¸ˆ': { ìœ í˜•: 'í˜„ê¸ˆ/ì˜ˆê¸ˆ', ê³„ì¢Œ: 'í•˜ë‚˜ì€í–‰', ë§¤ì…ê°€: 3000, í˜„ì¬ê°€: 3000 },
                    'ì•„íŒŒíŠ¸': { ìœ í˜•: 'ë¶€ë™ì‚°', ê³„ì¢Œ: 'ê¸°íƒ€', ë§¤ì…ê°€: 50000, í˜„ì¬ê°€: 55000 }
                },
                ìœ í˜•ë³„í•©ê³„: {
                    'êµ­ë‚´ ê°œë³„ì£¼ì‹': 5500,
                    'í•´ì™¸ ê°œë³„ì£¼ì‹': 0,
                    'êµ­ë‚´ ETF': 3200,
                    'í•´ì™¸ ETF': 2100,
                    'í˜„ê¸ˆ/ì˜ˆê¸ˆ': 3000,
                    'êµ­ë‚´ì±„ê¶Œ': 1020,
                    'í•´ì™¸ì±„ê¶Œ': 0,
                    'ë¶€ë™ì‚°': 55000,
                    'ê¸°íƒ€': 0
                }
            };
        }
        
        function í˜„ì¬ìì‚°ë°°ë¶„ì°¨íŠ¸ìƒì„±() {
            const ctx = document.getElementById('currentAssetChart');
            if (!ctx || !í˜„ì¬ìì‚°ë°ì´í„°) return;
            
            try {
                const ìœ í˜•ë³„ë°ì´í„° = í˜„ì¬ìì‚°ë°ì´í„°.ìœ í˜•ë³„í•©ê³„ || {};
                const ë¼ë²¨ë“¤ = [];
                const ë°ì´í„°ë“¤ = [];
                
                for (const [ìœ í˜•, ê¸ˆì•¡] of Object.entries(ìœ í˜•ë³„ë°ì´í„°)) {
                    if (ê¸ˆì•¡ > 0) {
                        ë¼ë²¨ë“¤.push(ìœ í˜•);
                        ë°ì´í„°ë“¤.push(ê¸ˆì•¡);
                    }
                }
                
                if (í˜„ì¬ìì‚°ì°¨íŠ¸) {
                    í˜„ì¬ìì‚°ì°¨íŠ¸.destroy();
                    í˜„ì¬ìì‚°ì°¨íŠ¸ = null;
                }
                
                if (ë¼ë²¨ë“¤.length > 0) {
                    í˜„ì¬ìì‚°ì°¨íŠ¸ = new Chart(ctx, {
                        type: 'doughnut',
                        data: {
                            labels: ë¼ë²¨ë“¤,
                            datasets: [{
                                data: ë°ì´í„°ë“¤,
                                backgroundColor: ì°¨íŠ¸ìƒ‰ìƒ.slice(0, ë¼ë²¨ë“¤.length),
                                borderWidth: 2,
                                borderColor: '#fff'
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: {
                                legend: {
                                    position: 'bottom',
                                    labels: { padding: 20, usePointStyle: true }
                                },
                                tooltip: {
                                    callbacks: {
                                        label: function(context) {
                                            const ì´ì•¡ = ë°ì´í„°ë“¤.reduce((sum, val) => sum + val, 0);
                                            const ë¹„ìœ¨ = ((context.parsed / ì´ì•¡) * 100).toFixed(1);
                                            return `${context.label}: ${context.parsed.toLocaleString()}ë§Œì› (${ë¹„ìœ¨}%)`;
                                        }
                                    }
                                }
                            }
                        }
                    });
                }
            } catch (error) {
                console.error('í˜„ì¬ìì‚°ì°¨íŠ¸ ìƒì„± ì˜¤ë¥˜:', error);
            }
        }
        
        function ëª©í‘œëŒ€ë¹„ë¹„êµì°¨íŠ¸ìƒì„±() {
            const ctx = document.getElementById('targetVsCurrentChart');
            if (!ctx || !í˜„ì¬ìì‚°ë°ì´í„°) return;
            
            try {
                const ì´ì•¡ = Object.values(í˜„ì¬ìì‚°ë°ì´í„°.ìœ í˜•ë³„í•©ê³„ || {}).reduce((sum, val) => sum + val, 0);
                if (ì´ì•¡ === 0) return;
                
                const í˜„ì¬ë¹„ìœ¨ = {
                    'êµ­ë‚´ì£¼ì‹': ((í˜„ì¬ìì‚°ë°ì´í„°.ìœ í˜•ë³„í•©ê³„['êµ­ë‚´ ê°œë³„ì£¼ì‹'] || 0) + (í˜„ì¬ìì‚°ë°ì´í„°.ìœ í˜•ë³„í•©ê³„['êµ­ë‚´ ETF'] || 0)) / ì´ì•¡ * 100,
                    'í•´ì™¸ì£¼ì‹': ((í˜„ì¬ìì‚°ë°ì´í„°.ìœ í˜•ë³„í•©ê³„['í•´ì™¸ ê°œë³„ì£¼ì‹'] || 0) + (í˜„ì¬ìì‚°ë°ì´í„°.ìœ í˜•ë³„í•©ê³„['í•´ì™¸ ETF'] || 0)) / ì´ì•¡ * 100,
                    'ì±„ê¶Œ': ((í˜„ì¬ìì‚°ë°ì´í„°.ìœ í˜•ë³„í•©ê³„['êµ­ë‚´ì±„ê¶Œ'] || 0) + (í˜„ì¬ìì‚°ë°ì´í„°.ìœ í˜•ë³„í•©ê³„['í•´ì™¸ì±„ê¶Œ'] || 0)) / ì´ì•¡ * 100,
                    'ë¶€ë™ì‚°': (í˜„ì¬ìì‚°ë°ì´í„°.ìœ í˜•ë³„í•©ê³„['ë¶€ë™ì‚°'] || 0) / ì´ì•¡ * 100,
                    'í˜„ê¸ˆ': (í˜„ì¬ìì‚°ë°ì´í„°.ìœ í˜•ë³„í•©ê³„['í˜„ê¸ˆ/ì˜ˆê¸ˆ'] || 0) / ì´ì•¡ * 100,
                    'ëŒ€ì•ˆíˆ¬ì': (í˜„ì¬ìì‚°ë°ì´í„°.ìœ í˜•ë³„í•©ê³„['ê¸°íƒ€'] || 0) / ì´ì•¡ * 100
                };
                
                const ë¼ë²¨ë“¤ = Object.keys(ëª©í‘œë°°ë¶„);
                const ëª©í‘œë°ì´í„° = ë¼ë²¨ë“¤.map(ë¼ë²¨ => ëª©í‘œë°°ë¶„[ë¼ë²¨] || 0);
                const í˜„ì¬ë°ì´í„° = ë¼ë²¨ë“¤.map(ë¼ë²¨ => í˜„ì¬ë¹„ìœ¨[ë¼ë²¨] || 0);
                
                if (ëª©í‘œëŒ€ë¹„ì°¨íŠ¸) {
                    ëª©í‘œëŒ€ë¹„ì°¨íŠ¸.destroy();
                    ëª©í‘œëŒ€ë¹„ì°¨íŠ¸ = null;
                }
                
                ëª©í‘œëŒ€ë¹„ì°¨íŠ¸ = new Chart(ctx, {
                    type: 'bar',
                    data: {
                        labels: ë¼ë²¨ë“¤,
                        datasets: [
                            {
                                label: 'ëª©í‘œ ë¹„ìœ¨',
                                data: ëª©í‘œë°ì´í„°,
                                backgroundColor: 'rgba(102, 126, 234, 0.7)',
                                borderColor: 'rgba(102, 126, 234, 1)',
                                borderWidth: 1
                            },
                            {
                                label: 'í˜„ì¬ ë¹„ìœ¨',
                                data: í˜„ì¬ë°ì´í„°,
                                backgroundColor: 'rgba(255, 99, 132, 0.7)',
                                borderColor: 'rgba(255, 99, 132, 1)',
                                borderWidth: 1
                            }
                        ]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            y: {
                                beginAtZero: true,
                                max: 50,
                                ticks: { callback: function(value) { return value + '%'; } }
                            }
                        },
                        plugins: {
                            legend: { position: 'top' },
                            tooltip: {
                                callbacks: {
                                    label: function(context) {
                                        return `${context.dataset.label}: ${context.parsed.y.toFixed(1)}%`;
                                    }
                                }
                            }
                        }
                    }
                });
            } catch (error) {
                console.error('ëª©í‘œëŒ€ë¹„ì°¨íŠ¸ ìƒì„± ì˜¤ë¥˜:', error);
            }
        }
        
        function í¬íŠ¸í´ë¦¬ì˜¤ë¶„ì„ìƒì„±() {
            const ë¶„ì„ì˜ì—­ = document.getElementById('portfolioAnalysis');
            if (!ë¶„ì„ì˜ì—­ || !í˜„ì¬ìì‚°ë°ì´í„°) return;
            
            try {
                const ì´ì•¡ = Object.values(í˜„ì¬ìì‚°ë°ì´í„°.ìœ í˜•ë³„í•©ê³„ || {}).reduce((sum, val) => sum + val, 0);
                if (ì´ì•¡ === 0) {
                    ë¶„ì„ì˜ì—­.innerHTML = '<p style="text-align: center; color: #666;">ë¶„ì„í•  ìì‚° ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.</p>';
                    return;
                }
                
                const ë¶„ì„ê²°ê³¼ = [];
                
                // ë¶€ë™ì‚° ë¹„ì¤‘ ë¶„ì„
                const ë¶€ë™ì‚°ë¹„ì¤‘ = (í˜„ì¬ìì‚°ë°ì´í„°.ìœ í˜•ë³„í•©ê³„['ë¶€ë™ì‚°'] || 0) / ì´ì•¡ * 100;
                if (ë¶€ë™ì‚°ë¹„ì¤‘ > 70) {
                    ë¶„ì„ê²°ê³¼.push({
                        ì œëª©: 'ë¶€ë™ì‚° í¸ì¤‘ ìœ„í—˜',
                        ì•„ì´ì½˜: 'ğŸš¨',
                        ë‚´ìš©: `ë¶€ë™ì‚° ë¹„ì¤‘ì´ ${ë¶€ë™ì‚°ë¹„ì¤‘.toFixed(1)}%ë¡œ ê³¼ë„í•©ë‹ˆë‹¤. ìœ ë™ì„± í™•ë³´ ë° ë¶„ì‚°íˆ¬ìë¥¼ ê¶Œì¥í•©ë‹ˆë‹¤.`
                    });
                } else {
                    ë¶„ì„ê²°ê³¼.push({
                        ì œëª©: 'ê· í˜•ì¡íŒ í¬íŠ¸í´ë¦¬ì˜¤',
                        ì•„ì´ì½˜: 'âœ…',
                        ë‚´ìš©: 'í˜„ì¬ í¬íŠ¸í´ë¦¬ì˜¤ê°€ ë¹„êµì  ê· í˜•ìˆê²Œ êµ¬ì„±ë˜ì–´ ìˆìŠµë‹ˆë‹¤. ì •ê¸°ì ì¸ ë¦¬ë°¸ëŸ°ì‹±ì„ ê¶Œì¥í•©ë‹ˆë‹¤.'
                    });
                }
                
                ë¶„ì„ì˜ì—­.innerHTML = ë¶„ì„ê²°ê³¼.map(ê²°ê³¼ => `
                    <div class="optimization-card">
                        <div class="optimization-header">
                            <div class="optimization-icon">${ê²°ê³¼.ì•„ì´ì½˜}</div>
                            <div class="optimization-title">${ê²°ê³¼.ì œëª©}</div>
                        </div>
                        <div class="optimization-content">${ê²°ê³¼.ë‚´ìš©}</div>
                    </div>
                `).join('');
            } catch (error) {
                console.error('í¬íŠ¸í´ë¦¬ì˜¤ ë¶„ì„ ì˜¤ë¥˜:', error);
            }
        }
        
        function í˜„ì¬ìì‚°ëª©ë¡í‘œì‹œ() {
            const ëª©ë¡ì˜ì—­ = document.getElementById('currentAssetsList');
            if (!ëª©ë¡ì˜ì—­ || !í˜„ì¬ìì‚°ë°ì´í„°) return;
            
            try {
                const ìì‚°ëª©ë¡ = í˜„ì¬ìì‚°ë°ì´í„°.í˜„ì¬ìì‚° || {};
                
                if (Object.keys(ìì‚°ëª©ë¡).length === 0) {
                    ëª©ë¡ì˜ì—­.innerHTML = '<p style="text-align: center; color: #666;">í‘œì‹œí•  ìì‚°ì´ ì—†ìŠµë‹ˆë‹¤.</p>';
                    return;
                }
                
                ëª©ë¡ì˜ì—­.innerHTML = `
                    <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 15px;">
                        ${Object.entries(ìì‚°ëª©ë¡).map(([ìì‚°ëª…, ì •ë³´]) => `
                            <div style="background: #f8f9fa; padding: 15px; border-radius: 10px; border-left: 4px solid #007bff;">
                                <div style="font-weight: bold; color: #333; margin-bottom: 8px;">${ìì‚°ëª…}</div>
                                <div style="font-size: 0.9em; color: #666; margin-bottom: 5px;">
                                    ğŸ“Š ${ì •ë³´.ìœ í˜•} | ğŸ¦ ${ì •ë³´.ê³„ì¢Œ}
                                </div>
                                <div style="display: flex; justify-content: space-between; align-items: center;">
                                    <span style="color: #666;">í˜„ì¬ê°€:</span>
                                    <span style="font-weight: bold; color: #007bff;">${ì •ë³´.í˜„ì¬ê°€?.toLocaleString() || 0}ë§Œì›</span>
                                </div>
                                <div style="display: flex; justify-content: space-between; align-items: center;">
                                    <span style="color: #666;">ë§¤ì…ê°€:</span>
                                    <span>${ì •ë³´.ë§¤ì…ê°€?.toLocaleString() || 0}ë§Œì›</span>
                                </div>
                                <div style="display: flex; justify-content: space-between; align-items: center; margin-top: 5px;">
                                    <span style="color: #666;">ìˆ˜ìµë¥ :</span>
                                    <span style="font-weight: bold; color: ${(ì •ë³´.í˜„ì¬ê°€ >= ì •ë³´.ë§¤ì…ê°€) ? '#28a745' : '#dc3545'};">
                                        ${ì •ë³´.ë§¤ì…ê°€ > 0 ? (((ì •ë³´.í˜„ì¬ê°€ - ì •ë³´.ë§¤ì…ê°€) / ì •ë³´.ë§¤ì…ê°€) * 100).toFixed(1) : 0}%
                                    </span>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                `;
            } catch (error) {
                console.error('ìì‚°ëª©ë¡ í‘œì‹œ ì˜¤ë¥˜:', error);
            }
        }
        
        function íƒ­ë³€ê²½(íƒ­ì´ë¦„) {
            try {
                // ëª¨ë“  íƒ­ ë¹„í™œì„±í™”
                document.querySelectorAll('.nav-tab').forEach(tab => tab.classList.remove('active'));
                document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
                
                // ì„ íƒëœ íƒ­ í™œì„±í™”
                event.target.classList.add('active');
                document.getElementById(íƒ­ì´ë¦„).classList.add('active');
                
                // ë¶„ì„ íƒ­ìœ¼ë¡œ ì´ë™ì‹œ ì°¨íŠ¸ ì—…ë°ì´íŠ¸ (ë””ë°”ìš´ìŠ¤ ì ìš©)
                if (íƒ­ì´ë¦„ === 'analysis') {
                    setTimeout(() => {
                        if (!ì°¨íŠ¸ì—…ë°ì´íŠ¸ì¤‘) {
                            ë””ë°”ìš´ìŠ¤ëœì°¨íŠ¸ì—…ë°ì´íŠ¸();
                            ë””ë°”ìš´ìŠ¤ëœë™ê¸°í™”ìƒíƒœí‘œì‹œ();
                        }
                    }, 200);
                }
            } catch (error) {
                console.error('íƒ­ ë³€ê²½ ì˜¤ë¥˜:', error);
            }
        }
        
        /*
        ===========================================
        â˜… ì•ˆì „í•œ ì´ˆê¸°í™” (ë¬´í•œë£¨í”„ ë°©ì§€)
        ===========================================
        */
        
        window.addEventListener('load', function() {
            console.log('ğŸš€ íˆ¬ìê³„íš ì‹œìŠ¤í…œ (ë¬´í•œë£¨í”„ ìˆ˜ì •) ì´ˆê¸°í™” ì‹œì‘');
            
            // ì´ˆê¸°í™” ì§€ì—° (DOM ì™„ì „ ë¡œë“œ ëŒ€ê¸°)
            setTimeout(() => {
                ìë™ë¶ˆëŸ¬ì˜¤ê¸°();
                
                // ì´ˆê¸° í™”ë©´ ì—…ë°ì´íŠ¸ (í•œ ë²ˆë§Œ)
                setTimeout(() => {
                    if (!ì°¨íŠ¸ì—…ë°ì´íŠ¸ì¤‘) {
                        ë””ë°”ìš´ìŠ¤ëœì°¨íŠ¸ì—…ë°ì´íŠ¸();
                        ë””ë°”ìš´ìŠ¤ëœë™ê¸°í™”ìƒíƒœí‘œì‹œ();
                    }
                }, 800);
            }, 300);
            
            console.log('âœ… ë¬´í•œë£¨í”„ ë°©ì§€ ì‹œìŠ¤í…œ í™œì„±í™”');
        });
        
        // â˜… ì•ˆì „í•œ ì €ì¥ì†Œ ë³€ê²½ ê°ì§€ (ë¬´í•œë£¨í”„ ë°©ì§€)
        window.addEventListener('storage', function(e) {
            // ìì‹ ì´ ì €ì¥í•œ ë°ì´í„°ëŠ” ë¬´ì‹œ
            if (ì €ì¥ì†Œê°ì§€ì¤‘ë‹¨) {
                console.log('ğŸ”’ ì €ì¥ì†Œ ê°ì§€ ì¤‘ë‹¨ ì¤‘ - ì´ë²¤íŠ¸ ë¬´ì‹œ');
                return;
            }
            
            // ë™ê¸°í™” ì¤‘ì´ë©´ ë¬´ì‹œ
            if (ìì‚°ë™ê¸°í™”ì¤‘ || ëª©í‘œë°°ë¶„ë™ê¸°í™”ì¤‘) {
                console.log('ğŸ”’ ë™ê¸°í™” ì§„í–‰ ì¤‘ - storage ì´ë²¤íŠ¸ ë¬´ì‹œ');
                return;
            }
            
            // ë„ˆë¬´ ë¹ˆë²ˆí•œ ê°ì§€ ë°©ì§€
            if (e.key === STORAGE_KEYS.ëª©í‘œë°°ë¶„) {
                console.log('ğŸ“Š ëª©í‘œë°°ë¶„ ë³€ê²½ ê°ì§€ - ë””ë°”ìš´ìŠ¤ ë™ê¸°í™”');
                ë””ë°”ìš´ìŠ¤(() => {
                    if (!ëª©í‘œë°°ë¶„ë™ê¸°í™”ì¤‘) {
                        ëª©í‘œë°°ë¶„ë™ê¸°í™”();
                    }
                }, 1000)();
            }
            
            if (e.key === STORAGE_KEYS.ìì‚°ë°ì´í„°) {
                console.log('ğŸ’° ìì‚°ë°ì´í„° ë³€ê²½ ê°ì§€ - ë””ë°”ìš´ìŠ¤ ë™ê¸°í™”');
                ë””ë°”ìš´ìŠ¤(() => {
                    if (!ìì‚°ë™ê¸°í™”ì¤‘) {
                        ìì‚°ë°ì´í„°ë™ê¸°í™”();
                    }
                }, 1000)();
            }
        });
        
        // í˜ì´ì§€ ì–¸ë¡œë“œ ì‹œ ì •ë¦¬
        window.addEventListener('beforeunload', function() {
            // íƒ€ì´ë¨¸ë“¤ ì •ë¦¬
            if (ìì‚°ë™ê¸°í™”íƒ€ì´ë¨¸) clearTimeout(ìì‚°ë™ê¸°í™”íƒ€ì´ë¨¸);
            if (ëª©í‘œë°°ë¶„ë™ê¸°í™”íƒ€ì´ë¨¸) clearTimeout(ëª©í‘œë°°ë¶„ë™ê¸°í™”íƒ€ì´ë¨¸);
            if (ì°¨íŠ¸ì—…ë°ì´íŠ¸íƒ€ì´ë¨¸) clearTimeout(ì°¨íŠ¸ì—…ë°ì´íŠ¸íƒ€ì´ë¨¸);
            if (ìë™ì €ì¥íƒ€ì´ë¨¸) clearTimeout(ìë™ì €ì¥íƒ€ì´ë¨¸);
            
            // ì°¨íŠ¸ ì •ë¦¬
            if (í˜„ì¬ìì‚°ì°¨íŠ¸) {
                í˜„ì¬ìì‚°ì°¨íŠ¸.destroy();
                í˜„ì¬ìì‚°ì°¨íŠ¸ = null;
            }
            if (ëª©í‘œëŒ€ë¹„ì°¨íŠ¸) {
                ëª©í‘œëŒ€ë¹„ì°¨íŠ¸.destroy();
                ëª©í‘œëŒ€ë¹„ì°¨íŠ¸ = null;
            }
        });
    </script>
</body>
</html>