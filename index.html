<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì‘ê¸‰ì˜í•™ê³¼ ì „ë¬¸ì˜ ì¢…í•© ìì‚°ê´€ë¦¬ ëŒ€ì‹œë³´ë“œ</title>
    <!-- Favicon ì˜¤ë¥˜ ì™„ì „ ì°¨ë‹¨ -->
    <link rel="icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 32 32'%3E%3Crect width='32' height='32' rx='6' fill='%23667eea'/%3E%3Cpath d='M16 8c0-.553-.447-1-1-1h-2c-.553 0-1 .447-1 1v4H8c-.553 0-1 .447-1 1v2c0 .553.447 1 1 1h4v4c0 .553.447 1 1 1h2c.553 0 1-.447 1-1v-4h4c.553 0 1-.447 1-1v-2c0-.553-.447-1-1-1h-4V8z' fill='white'/%3E%3Ccircle cx='24' cy='24' r='3' fill='%2328a745'/%3E%3C/svg%3E">
    <link rel="shortcut icon" href="data:image/x-icon;," type="image/x-icon">
    <style>
        /*
        ===========================================
        í†µí•© ëŒ€ì‹œë³´ë“œ ê¸°ë³¸ ìŠ¤íƒ€ì¼
        ===========================================
        */
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .dashboard-container {
            max-width: 1600px;
            margin: 0 auto;
        }
        
        /* í—¤ë” ì˜ì—­ */
        .dashboard-header {
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            padding: 30px;
            margin-bottom: 30px;
            text-align: center;
        }
        
        .dashboard-title {
            font-size: 2.5em;
            color: #333;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
        }
        
        .dashboard-subtitle {
            color: #666;
            font-size: 1.2em;
        }
        
        .last-update {
            color: #999;
            font-size: 0.9em;
            margin-top: 10px;
        }
        
        /* ë™ê¸°í™” ìƒíƒœ í‘œì‹œ */
        .sync-status {
            position: fixed;
            top: 20px;
            right: 20px;
            background: white;
            border-radius: 10px;
            padding: 15px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.2);
            z-index: 1000;
            min-width: 200px;
        }
        
        .sync-indicator {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 5px;
        }
        
        .sync-dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: #dc3545;
        }
        
        .sync-dot.connected {
            background: #28a745;
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }
        
        /* ìš”ì•½ ì •ë³´ ì„¹ì…˜ */
        .summary-section {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .summary-card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.08);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .summary-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 5px;
            background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
        }
        
        .summary-card.income::before {
            background: linear-gradient(90deg, #28a745 0%, #20c997 100%);
        }
        
        .summary-card.expense::before {
            background: linear-gradient(90deg, #dc3545 0%, #fd7e14 100%);
        }
        
        .summary-card.investment::before {
            background: linear-gradient(90deg, #007bff 0%, #17a2b8 100%);
        }
        
        .summary-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0,0,0,0.15);
        }
        
        .summary-icon {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5em;
            margin-bottom: 15px;
        }
        
        .summary-icon.assets {
            background: rgba(102, 126, 234, 0.1);
            color: #667eea;
        }
        
        .summary-icon.income {
            background: rgba(40, 167, 69, 0.1);
            color: #28a745;
        }
        
        .summary-icon.expense {
            background: rgba(220, 53, 69, 0.1);
            color: #dc3545;
        }
        
        .summary-icon.investment {
            background: rgba(0, 123, 255, 0.1);
            color: #007bff;
        }
        
        .summary-label {
            color: #666;
            font-size: 0.9em;
            margin-bottom: 5px;
        }
        
        .summary-value {
            font-size: 1.8em;
            font-weight: bold;
            color: #333;
            margin-bottom: 5px;
        }
        
        .summary-detail {
            font-size: 0.85em;
            color: #999;
        }
        
        /* ëª¨ë“ˆ íƒ­ ë„¤ë¹„ê²Œì´ì…˜ */
        .module-tabs {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            background: white;
            padding: 15px;
            border-radius: 15px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.08);
        }
        
        .module-tab {
            flex: 1;
            padding: 15px 25px;
            background: #f8f9fa;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-size: 1.1em;
            font-weight: 500;
            color: #666;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        
        .module-tab.active {
            background: #667eea;
            color: white;
            transform: scale(1.02);
        }
        
        .module-tab:hover:not(.active) {
            background: #e9ecef;
            color: #333;
        }
        
        /* ëª¨ë“ˆ ì»¨í…Œì´ë„ˆ */
        .module-container {
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            overflow: hidden;
            position: relative;
            min-height: 600px;
        }
        
        .module-frame {
            width: 100%;
            height: 800px;
            border: none;
            display: none;
        }
        
        .module-frame.active {
            display: block;
        }
        
        /* ë¡œë”© ìƒíƒœ */
        .loading-state {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
            display: none;
        }
        
        .loading-state.active {
            display: block;
        }
        
        .loading-spinner {
            width: 50px;
            height: 50px;
            border: 5px solid #f3f3f3;
            border-top: 5px solid #667eea;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* ìƒíƒœ ë©”ì‹œì§€ */
        .status-message {
            position: fixed;
            bottom: 20px;
            right: 20px;
            padding: 15px 25px;
            border-radius: 10px;
            background: #28a745;
            color: white;
            font-weight: 500;
            box-shadow: 0 5px 20px rgba(0,0,0,0.2);
            opacity: 0;
            transform: translateY(20px);
            transition: all 0.3s ease;
            z-index: 1000;
        }
        
        .status-message.show {
            opacity: 1;
            transform: translateY(0);
        }
        
        .status-message.error {
            background: #dc3545;
        }
        
        .status-message.info {
            background: #17a2b8;
        }
        
        /* í€µ ì•¡ì…˜ ë²„íŠ¼ë“¤ */
        .quick-actions {
            position: fixed;
            bottom: 100px;
            right: 30px;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        
        .quick-action-btn {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: #667eea;
            color: white;
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.3em;
            box-shadow: 0 5px 20px rgba(0,0,0,0.2);
            transition: all 0.3s ease;
        }
        
        .quick-action-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 8px 25px rgba(0,0,0,0.3);
        }
        
        .quick-action-btn.refresh {
            background: #28a745;
        }
        
        .quick-action-btn.settings {
            background: #6c757d;
        }
        
        /* ë°˜ì‘í˜• ë””ìì¸ */
        @media (max-width: 768px) {
            .dashboard-title {
                font-size: 1.8em;
            }
            
            .summary-section {
                grid-template-columns: 1fr;
            }
            
            .module-tabs {
                flex-direction: column;
            }
            
            .module-frame {
                height: 600px;
            }
            
            .quick-actions {
                bottom: 20px;
                right: 20px;
            }
            
            .sync-status {
                position: relative;
                top: auto;
                right: auto;
                margin-bottom: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="dashboard-container">
        <!-- ë™ê¸°í™” ìƒíƒœ í‘œì‹œ -->
        <div class="sync-status">
            <div class="sync-indicator">
                <div class="sync-dot" id="module1SyncDot"></div>
                <span id="module1SyncStatus">ëª¨ë“ˆ1: ì—°ê²° ì¤‘...</span>
            </div>
            <div class="sync-indicator">
                <div class="sync-dot" id="module2SyncDot"></div>
                <span id="module2SyncStatus">ëª¨ë“ˆ2: ì—°ê²° ì¤‘...</span>
            </div>
            <div style="font-size: 0.8em; color: #666; margin-top: 10px;">
                ë§ˆì§€ë§‰ ë™ê¸°í™”: <span id="lastSyncTime">-</span>
            </div>
        </div>
        
        <!-- ëŒ€ì‹œë³´ë“œ í—¤ë” -->
        <div class="dashboard-header">
            <h1 class="dashboard-title">
                <span>ğŸ¥</span>
                <span>ì‘ê¸‰ì˜í•™ê³¼ ì „ë¬¸ì˜ ì¢…í•© ìì‚°ê´€ë¦¬ ëŒ€ì‹œë³´ë“œ</span>
            </h1>
            <p class="dashboard-subtitle">ìì‚° í˜„í™©, ìˆ˜ì…/ì§€ì¶œ, íˆ¬ìì—¬ë ¥ì„ í•œëˆˆì— ê´€ë¦¬í•˜ì„¸ìš”</p>
            <div class="last-update">ë§ˆì§€ë§‰ ì—…ë°ì´íŠ¸: <span id="lastUpdateTime">-</span></div>
        </div>
        
        <!-- ìš”ì•½ ì •ë³´ ì„¹ì…˜ -->
        <div class="summary-section">
            <!-- ì´ ìì‚° ì¹´ë“œ -->
            <div class="summary-card">
                <div class="summary-icon assets">ğŸ’°</div>
                <div class="summary-label">ì´ ìì‚°</div>
                <div class="summary-value" id="totalAssetsValue">-</div>
                <div class="summary-detail" id="totalAssetsDetail">ìì‚° 0ê°œ ë“±ë¡</div>
            </div>
            
            <!-- ì›” ìˆ˜ì… ì¹´ë“œ -->
            <div class="summary-card income">
                <div class="summary-icon income">ğŸ’µ</div>
                <div class="summary-label">ì›” ì´ìˆ˜ì…</div>
                <div class="summary-value" id="monthlyIncomeValue">-</div>
                <div class="summary-detail" id="monthlyIncomeDetail">ìˆ˜ì… 0ê±´</div>
            </div>
            
            <!-- ì›” ì§€ì¶œ ì¹´ë“œ -->
            <div class="summary-card expense">
                <div class="summary-icon expense">ğŸ’³</div>
                <div class="summary-label">ì›” ì´ì§€ì¶œ</div>
                <div class="summary-value" id="monthlyExpenseValue">-</div>
                <div class="summary-detail" id="monthlyExpenseDetail">ì§€ì¶œ 0ê±´</div>
            </div>
            
            <!-- íˆ¬ìì—¬ë ¥ ì¹´ë“œ -->
            <div class="summary-card investment">
                <div class="summary-icon investment">ğŸ“ˆ</div>
                <div class="summary-label">ì›” íˆ¬ìì—¬ë ¥</div>
                <div class="summary-value" id="investmentCapacityValue">-</div>
                <div class="summary-detail" id="investmentCapacityDetail">ìˆ˜ì… - ì§€ì¶œ</div>
            </div>
        </div>
        
        <!-- ëª¨ë“ˆ íƒ­ ë„¤ë¹„ê²Œì´ì…˜ -->
        <div class="module-tabs">
            <button class="module-tab active" onclick="ëª¨ë“ˆì „í™˜('module1')">
                <span>ğŸ“Š</span>
                <span>ìì‚° í˜„í™© ê´€ë¦¬</span>
            </button>
            <button class="module-tab" onclick="ëª¨ë“ˆì „í™˜('module2')">
                <span>ğŸ’°</span>
                <span>ìˆ˜ì…/ì§€ì¶œ ê´€ë¦¬</span>
            </button>
        </div>
        
        <!-- ëª¨ë“ˆ ì»¨í…Œì´ë„ˆ -->
        <div class="module-container">
            <!-- ë¡œë”© ìƒíƒœ -->
            <div class="loading-state active" id="loadingState">
                <div class="loading-spinner"></div>
                <p>ëª¨ë“ˆì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</p>
            </div>
            
            <!-- ëª¨ë“ˆ 1: ìì‚° í˜„í™© -->
            <iframe id="module1" class="module-frame active" src="assets.html"></iframe>
            
            <!-- ëª¨ë“ˆ 2: ìˆ˜ì…/ì§€ì¶œ -->
            <iframe id="module2" class="module-frame" src="income_expense.html"></iframe>
        </div>
    </div>
    
    <!-- í€µ ì•¡ì…˜ ë²„íŠ¼ë“¤ -->
    <div class="quick-actions">
        <button class="quick-action-btn refresh" onclick="ì „ì²´ë°ì´í„°ìƒˆë¡œê³ ì¹¨()" title="ë°ì´í„° ìƒˆë¡œê³ ì¹¨">
            ğŸ”„
        </button>
        <button class="quick-action-btn settings" onclick="ë””ë²„ê·¸ëª¨ë“œí† ê¸€()" title="ë””ë²„ê·¸ ëª¨ë“œ">
            ğŸ”§
        </button>
    </div>
    
    <!-- ìƒíƒœ ë©”ì‹œì§€ -->
    <div class="status-message" id="statusMessage"></div>
    
    <script>
        /*
        ===========================================
        â­ ê°œì„ ëœ í†µí•© ëŒ€ì‹œë³´ë“œ ë©”ì¸ ìŠ¤í¬ë¦½íŠ¸ â­
        ===========================================
        */
        
        // ì „ì—­ ë³€ìˆ˜
        let í˜„ì¬ëª¨ë“ˆ = 'module1';
        let ëª¨ë“ˆ1ì—°ê²°ìƒíƒœ = false;
        let ëª¨ë“ˆ2ì—°ê²°ìƒíƒœ = false;
        let ëª¨ë“ˆ1ë°ì´í„° = null;
        let ëª¨ë“ˆ2ë°ì´í„° = null;
        let ë””ë²„ê·¸ëª¨ë“œ = false;
        
        // â­ ìˆ˜ì •ëœ localStorage í‚¤ ì´ë¦„ (ëª¨ë“ˆê³¼ ì •í™•íˆ ì¼ì¹˜)
        const STORAGE_KEYS = {
            ëª¨ë“ˆ1: 'module1_asset_data',
            ëª¨ë“ˆ2: 'module2_monthly_data'
        };
        
        // ë””ë²„ê¹…ìš© ë¡œê·¸ í•¨ìˆ˜
        function ë¡œê·¸(ë©”ì‹œì§€, ë°ì´í„° = null) {
            const ì‹œê°„ = new Date().toLocaleTimeString();
            const ë¡œê·¸ë©”ì‹œì§€ = `[${ì‹œê°„}] ğŸ” ëŒ€ì‹œë³´ë“œ: ${ë©”ì‹œì§€}`;
            
            if (ë””ë²„ê·¸ëª¨ë“œ) {
                console.log(ë¡œê·¸ë©”ì‹œì§€);
                if (ë°ì´í„°) {
                    console.log('ğŸ“Š ë°ì´í„°:', ë°ì´í„°);
                }
            }
        }
        
        // ë””ë²„ê·¸ ëª¨ë“œ í† ê¸€
        function ë””ë²„ê·¸ëª¨ë“œí† ê¸€() {
            ë””ë²„ê·¸ëª¨ë“œ = !ë””ë²„ê·¸ëª¨ë“œ;
            ìƒíƒœë©”ì‹œì§€í‘œì‹œ(`ë””ë²„ê·¸ ëª¨ë“œ ${ë””ë²„ê·¸ëª¨ë“œ ? 'í™œì„±í™”' : 'ë¹„í™œì„±í™”'}`, 'info');
            ë¡œê·¸(`ë””ë²„ê·¸ ëª¨ë“œ ${ë””ë²„ê·¸ëª¨ë“œ ? 'ON' : 'OFF'}`);
            
            if (ë””ë²„ê·¸ëª¨ë“œ) {
                // ë””ë²„ê·¸ ì •ë³´ í‘œì‹œ
                setTimeout(() => {
                    ë¡œê·¸('=== ë””ë²„ê·¸ ì •ë³´ ===');
                    ë¡œê·¸('ëª¨ë“ˆ1 ì—°ê²°ìƒíƒœ', ëª¨ë“ˆ1ì—°ê²°ìƒíƒœ);
                    ë¡œê·¸('ëª¨ë“ˆ2 ì—°ê²°ìƒíƒœ', ëª¨ë“ˆ2ì—°ê²°ìƒíƒœ);
                    ë¡œê·¸('ëª¨ë“ˆ1 ë°ì´í„°', ëª¨ë“ˆ1ë°ì´í„°);
                    ë¡œê·¸('ëª¨ë“ˆ2 ë°ì´í„°', ëª¨ë“ˆ2ë°ì´í„°);
                    ë¡œê·¸('localStorage í‚¤ë“¤', Object.keys(localStorage));
                }, 100);
            }
        }
        
        /*
        ===========================================
        â­ ì™„ì „íˆ ìƒˆë¡œìš´ ëª¨ë“ˆ í†µì‹  ë° ë°ì´í„° ê´€ë¦¬ â­
        ===========================================
        */
        
        // â­ ê°•í™”ëœ localStorage ë³€ê²½ ê°ì§€
        let ì €ì¥ì†Œê°ì§€íƒ€ì´ë¨¸ = null;
        function ì €ì¥ì†Œë³€ê²½ê°ì§€ì‹œì‘() {
            // ê¸°ì¡´ íƒ€ì´ë¨¸ ì •ë¦¬
            if (ì €ì¥ì†Œê°ì§€íƒ€ì´ë¨¸) {
                clearInterval(ì €ì¥ì†Œê°ì§€íƒ€ì´ë¨¸);
            }
            
            // 1ì´ˆë§ˆë‹¤ localStorage í™•ì¸
            ì €ì¥ì†Œê°ì§€íƒ€ì´ë¨¸ = setInterval(() => {
                const í˜„ì¬ì‹œì  = new Date().getTime();
                
                // ëª¨ë“ˆ1 ë°ì´í„° í™•ì¸
                try {
                    const ëª¨ë“ˆ1ì €ì¥ë°ì´í„° = localStorage.getItem(STORAGE_KEYS.ëª¨ë“ˆ1);
                    if (ëª¨ë“ˆ1ì €ì¥ë°ì´í„°) {
                        const íŒŒì‹±ë°ì´í„° = JSON.parse(ëª¨ë“ˆ1ì €ì¥ë°ì´í„°);
                        const ë§ˆì§€ë§‰ì—…ë°ì´íŠ¸ = new Date(íŒŒì‹±ë°ì´í„°.ë§ˆì§€ë§‰ì—…ë°ì´íŠ¸ || 0).getTime();
                        
                        // ìµœê·¼ 5ì´ˆ ë‚´ ì—…ë°ì´íŠ¸ëœ ë°ì´í„°ë§Œ ì²˜ë¦¬
                        if (í˜„ì¬ì‹œì  - ë§ˆì§€ë§‰ì—…ë°ì´íŠ¸ < 5000) {
                            if (!ëª¨ë“ˆ1ë°ì´í„° || ëª¨ë“ˆ1ë°ì´í„°.ë§ˆì§€ë§‰ì—…ë°ì´íŠ¸ !== íŒŒì‹±ë°ì´í„°.ë§ˆì§€ë§‰ì—…ë°ì´íŠ¸) {
                                ë¡œê·¸('ğŸ”„ ëª¨ë“ˆ1 ë°ì´í„° ìë™ ê°ì§€ ë° ë™ê¸°í™”');
                                ëª¨ë“ˆ1ë°ì´í„°ì½ê¸°();
                            }
                        }
                    }
                } catch (error) {
                    ë¡œê·¸('âŒ ëª¨ë“ˆ1 ì €ì¥ì†Œ ê°ì§€ ì˜¤ë¥˜', error);
                }
                
                // â­ ëª¨ë“ˆ2 ë°ì´í„° í™•ì¸ (ê°œì„ )
                try {
                    const ëª¨ë“ˆ2ì €ì¥ë°ì´í„° = localStorage.getItem(STORAGE_KEYS.ëª¨ë“ˆ2);
                    if (ëª¨ë“ˆ2ì €ì¥ë°ì´í„°) {
                        const íŒŒì‹±ë°ì´í„° = JSON.parse(ëª¨ë“ˆ2ì €ì¥ë°ì´í„°);
                        const ë§ˆì§€ë§‰ì—…ë°ì´íŠ¸ = new Date(íŒŒì‹±ë°ì´í„°.ë§ˆì§€ë§‰ì—…ë°ì´íŠ¸ || 0).getTime();
                        
                        // ìµœê·¼ 5ì´ˆ ë‚´ ì—…ë°ì´íŠ¸ëœ ë°ì´í„°ë§Œ ì²˜ë¦¬
                        if (í˜„ì¬ì‹œì  - ë§ˆì§€ë§‰ì—…ë°ì´íŠ¸ < 5000) {
                            if (!ëª¨ë“ˆ2ë°ì´í„° || ëª¨ë“ˆ2ë°ì´í„°.ë§ˆì§€ë§‰ì—…ë°ì´íŠ¸ !== íŒŒì‹±ë°ì´í„°.ë§ˆì§€ë§‰ì—…ë°ì´íŠ¸) {
                                ë¡œê·¸('ğŸ”„ ëª¨ë“ˆ2 ë°ì´í„° ìë™ ê°ì§€ ë° ë™ê¸°í™”');
                                ëª¨ë“ˆ2ë°ì´í„°ì½ê¸°();
                            }
                        }
                    }
                } catch (error) {
                    ë¡œê·¸('âŒ ëª¨ë“ˆ2 ì €ì¥ì†Œ ê°ì§€ ì˜¤ë¥˜', error);
                }
            }, 1000);
            
            ë¡œê·¸('âœ… ì €ì¥ì†Œ ë³€ê²½ ê°ì§€ ì‹œì‘ë¨');
        }
        
        // â­ ê°œì„ ëœ ëª¨ë“ˆ1 ë°ì´í„° ì½ê¸°
        function ëª¨ë“ˆ1ë°ì´í„°ì½ê¸°() {
            try {
                const ì €ì¥ëœë°ì´í„° = localStorage.getItem(STORAGE_KEYS.ëª¨ë“ˆ1);
                if (ì €ì¥ëœë°ì´í„°) {
                    const ë°ì´í„° = JSON.parse(ì €ì¥ëœë°ì´í„°);
                    ë¡œê·¸('ğŸ“Š ëª¨ë“ˆ1 ë°ì´í„° ì½ê¸° ì„±ê³µ', ë°ì´í„°);
                    
                    // â­ ì•ˆì „í•œ ë°ì´í„° êµ¬ì¡° ì¶”ì¶œ
                    const ì•ˆì „í•œìœ í˜•ë³„í•©ê³„ = ë°ì´í„°.ìœ í˜•ë³„í•©ê³„ || {};
                    const ì•ˆì „í•œí˜„ì¬ìì‚° = ë°ì´í„°.í˜„ì¬ìì‚° || {};
                    const ì•ˆì „í•œê³„ì¢Œë³„í•©ê³„ = ë°ì´í„°.ê³„ì¢Œë³„í•©ê³„ || {};
                    
                    // ì´ìì‚° ê³„ì‚° (ì•ˆì „í•˜ê²Œ)
                    let ì´ìì‚° = 0;
                    try {
                        ì´ìì‚° = Object.values(ì•ˆì „í•œìœ í˜•ë³„í•©ê³„).reduce((sum, val) => {
                            const ìˆ«ìê°’ = parseFloat(val) || 0;
                            return sum + ìˆ«ìê°’;
                        }, 0);
                    } catch (error) {
                        ë¡œê·¸('âš ï¸ ì´ìì‚° ê³„ì‚° ì˜¤ë¥˜', error);
                        ì´ìì‚° = 0;
                    }
                    
                    ëª¨ë“ˆ1ë°ì´í„° = {
                        ì´ìì‚°: ì´ìì‚°,
                        ìì‚°ê°œìˆ˜: Object.keys(ì•ˆì „í•œí˜„ì¬ìì‚°).length,
                        í˜„ì¬ìì‚°: ì•ˆì „í•œí˜„ì¬ìì‚°,
                        ìœ í˜•ë³„í•©ê³„: ì•ˆì „í•œìœ í˜•ë³„í•©ê³„,
                        ê³„ì¢Œë³„í•©ê³„: ì•ˆì „í•œê³„ì¢Œë³„í•©ê³„,
                        ë§ˆì§€ë§‰ì—…ë°ì´íŠ¸: ë°ì´í„°.ë§ˆì§€ë§‰ì—…ë°ì´íŠ¸ || new Date().toISOString()
                    };
                    
                    // ì—°ê²° ìƒíƒœ ì—…ë°ì´íŠ¸
                    ëª¨ë“ˆ1ì—°ê²°ìƒíƒœ = true;
                    ë™ê¸°í™”ìƒíƒœì—…ë°ì´íŠ¸();
                    
                    ëª¨ë“ˆ1ë°ì´í„°ì—…ë°ì´íŠ¸();
                    ë¡œê·¸('âœ… ëª¨ë“ˆ1 ë°ì´í„° ì²˜ë¦¬ ì™„ë£Œ', ëª¨ë“ˆ1ë°ì´í„°);
                    return true;
                } else {
                    ë¡œê·¸('âš ï¸ ëª¨ë“ˆ1 ì €ì¥ëœ ë°ì´í„° ì—†ìŒ');
                    ëª¨ë“ˆ1ì—°ê²°ìƒíƒœ = false;
                    ë™ê¸°í™”ìƒíƒœì—…ë°ì´íŠ¸();
                    return false;
                }
            } catch (error) {
                ë¡œê·¸('âŒ ëª¨ë“ˆ1 ë°ì´í„° ì½ê¸° ì‹¤íŒ¨', error);
                ëª¨ë“ˆ1ì—°ê²°ìƒíƒœ = false;
                ë™ê¸°í™”ìƒíƒœì—…ë°ì´íŠ¸();
                return false;
            }
        }
        
        // â­ ì™„ì „íˆ ìƒˆë¡œìš´ ëª¨ë“ˆ2 ë°ì´í„° ì½ê¸° í•¨ìˆ˜
        function ëª¨ë“ˆ2ë°ì´í„°ì½ê¸°() {
            try {
                ë¡œê·¸('ğŸ“‚ ëª¨ë“ˆ2 ë°ì´í„° ì½ê¸° ì‹œì‘');
                
                const ì €ì¥ëœë°ì´í„° = localStorage.getItem(STORAGE_KEYS.ëª¨ë“ˆ2);
                if (ì €ì¥ëœë°ì´í„°) {
                    const ë°ì´í„° = JSON.parse(ì €ì¥ëœë°ì´í„°);
                    ë¡œê·¸('ğŸ’° ëª¨ë“ˆ2 ì €ì¥ëœ ë°ì´í„° ë°œê²¬', ë°ì´í„°);
                    
                    // â­ ê°œì„ ëœ ë°ì´í„° êµ¬ì¡° ì²˜ë¦¬
                    const ì•ˆì „í•œì›”ë³„ë°ì´í„° = ë°ì´í„°.ì›”ë³„ë°ì´í„° || {};
                    
                    // í˜„ì¬ ì›” ê³„ì‚°
                    let í˜„ì¬ë…„ì›” = new Date();
                    if (ë°ì´í„°.í˜„ì¬ë…„ì›”) {
                        í˜„ì¬ë…„ì›” = new Date(ë°ì´í„°.í˜„ì¬ë…„ì›”.year, ë°ì´í„°.í˜„ì¬ë…„ì›”.month);
                    }
                    const í˜„ì¬ì›”í‚¤ = `${í˜„ì¬ë…„ì›”.getFullYear()}-${String(í˜„ì¬ë…„ì›”.getMonth() + 1).padStart(2, '0')}`;
                    
                    ë¡œê·¸('ğŸ“… í˜„ì¬ ì›” í‚¤', í˜„ì¬ì›”í‚¤);
                    
                    // â­ ì•ˆì „í•œ ê³„ì‚° (ì—¬ëŸ¬ ë°©ë²•ìœ¼ë¡œ ì‹œë„)
                    let ì›”ìˆ˜ì… = 0;
                    let ì›”ì§€ì¶œ = 0;
                    let ìˆ˜ì…ê±´ìˆ˜ = 0;
                    let ì§€ì¶œê±´ìˆ˜ = 0;
                    
                    // ë°©ë²• 1: ì €ì¥ëœ ìš”ì•½ ë°ì´í„° ì‚¬ìš©
                    if (ë°ì´í„°.ì›”ìˆ˜ì… !== undefined && ë°ì´í„°.ì›”ì§€ì¶œ !== undefined) {
                        ë¡œê·¸('ğŸ’° ì €ì¥ëœ ìš”ì•½ ë°ì´í„° ì‚¬ìš©');
                        ì›”ìˆ˜ì… = ë°ì´í„°.ì›”ìˆ˜ì… || 0;
                        ì›”ì§€ì¶œ = ë°ì´í„°.ì›”ì§€ì¶œ || 0;
                        ìˆ˜ì…ê±´ìˆ˜ = ë°ì´í„°.ìˆ˜ì…ê±´ìˆ˜ || 0;
                        ì§€ì¶œê±´ìˆ˜ = ë°ì´í„°.ì§€ì¶œê±´ìˆ˜ || 0;
                    } else {
                        ë¡œê·¸('ğŸ’° ì›”ë³„ ë°ì´í„°ì—ì„œ ì§ì ‘ ê³„ì‚°');
                        // ë°©ë²• 2: í˜„ì¬ ì›” ë°ì´í„°ì—ì„œ ì§ì ‘ ê³„ì‚°
                        const í˜„ì¬ì›”ë°ì´í„° = ì•ˆì „í•œì›”ë³„ë°ì´í„°[í˜„ì¬ì›”í‚¤];
                        if (í˜„ì¬ì›”ë°ì´í„°) {
                            const ìˆ˜ì…ë°°ì—´ = Array.isArray(í˜„ì¬ì›”ë°ì´í„°.ìˆ˜ì…) ? í˜„ì¬ì›”ë°ì´í„°.ìˆ˜ì… : [];
                            const ì§€ì¶œë°°ì—´ = Array.isArray(í˜„ì¬ì›”ë°ì´í„°.ì§€ì¶œ) ? í˜„ì¬ì›”ë°ì´í„°.ì§€ì¶œ : [];
                            
                            ì›”ìˆ˜ì… = ìˆ˜ì…ë°°ì—´.reduce((sum, item) => sum + (parseFloat(item.ê¸ˆì•¡) || 0), 0);
                            ì›”ì§€ì¶œ = ì§€ì¶œë°°ì—´.reduce((sum, item) => sum + (parseFloat(item.ê¸ˆì•¡) || 0), 0);
                            ìˆ˜ì…ê±´ìˆ˜ = ìˆ˜ì…ë°°ì—´.length;
                            ì§€ì¶œê±´ìˆ˜ = ì§€ì¶œë°°ì—´.length;
                        }
                    }
                    
                    const íˆ¬ìì—¬ë ¥ = ì›”ìˆ˜ì… - ì›”ì§€ì¶œ;
                    
                    ë¡œê·¸('ğŸ’° ê³„ì‚°ëœ ê°’ë“¤', { ì›”ìˆ˜ì…, ì›”ì§€ì¶œ, íˆ¬ìì—¬ë ¥, ìˆ˜ì…ê±´ìˆ˜, ì§€ì¶œê±´ìˆ˜ });
                    
                    ëª¨ë“ˆ2ë°ì´í„° = {
                        ì›”ë³„ë°ì´í„°: ì•ˆì „í•œì›”ë³„ë°ì´í„°,
                        ì›”ìˆ˜ì…: ì›”ìˆ˜ì…,
                        ì›”ì§€ì¶œ: ì›”ì§€ì¶œ,
                        íˆ¬ìì—¬ë ¥: íˆ¬ìì—¬ë ¥,
                        ìˆ˜ì…ê±´ìˆ˜: ìˆ˜ì…ê±´ìˆ˜,
                        ì§€ì¶œê±´ìˆ˜: ì§€ì¶œê±´ìˆ˜,
                        í˜„ì¬ë…„ì›”: ë°ì´í„°.í˜„ì¬ë…„ì›” || { year: í˜„ì¬ë…„ì›”.getFullYear(), month: í˜„ì¬ë…„ì›”.getMonth() },
                        ë§ˆì§€ë§‰ì—…ë°ì´íŠ¸: ë°ì´í„°.ë§ˆì§€ë§‰ì—…ë°ì´íŠ¸ || new Date().toISOString()
                    };
                    
                    // ì—°ê²° ìƒíƒœ ì—…ë°ì´íŠ¸
                    ëª¨ë“ˆ2ì—°ê²°ìƒíƒœ = true;
                    ë™ê¸°í™”ìƒíƒœì—…ë°ì´íŠ¸();
                    
                    ëª¨ë“ˆ2ë°ì´í„°ì—…ë°ì´íŠ¸();
                    ë¡œê·¸('âœ… ëª¨ë“ˆ2 ë°ì´í„° ì²˜ë¦¬ ì™„ë£Œ', ëª¨ë“ˆ2ë°ì´í„°);
                    return true;
                } else {
                    ë¡œê·¸('âš ï¸ ëª¨ë“ˆ2 ì €ì¥ëœ ë°ì´í„° ì—†ìŒ');
                    ëª¨ë“ˆ2ì—°ê²°ìƒíƒœ = false;
                    ë™ê¸°í™”ìƒíƒœì—…ë°ì´íŠ¸();
                    return false;
                }
            } catch (error) {
                ë¡œê·¸('âŒ ëª¨ë“ˆ2 ë°ì´í„° ì½ê¸° ì‹¤íŒ¨', error);
                console.error('ëª¨ë“ˆ2 ë°ì´í„° ì½ê¸° ì‹¤íŒ¨ ìƒì„¸:', error);
                ëª¨ë“ˆ2ì—°ê²°ìƒíƒœ = false;
                ë™ê¸°í™”ìƒíƒœì—…ë°ì´íŠ¸();
                return false;
            }
        }
        
        // â­ ë™ê¸°í™” ìƒíƒœ UI ì—…ë°ì´íŠ¸
        function ë™ê¸°í™”ìƒíƒœì—…ë°ì´íŠ¸() {
            // ëª¨ë“ˆ1 ìƒíƒœ
            const ëª¨ë“ˆ1ì  = document.getElementById('module1SyncDot');
            const ëª¨ë“ˆ1ìƒíƒœ = document.getElementById('module1SyncStatus');
            
            if (ëª¨ë“ˆ1ì—°ê²°ìƒíƒœ) {
                ëª¨ë“ˆ1ì .classList.add('connected');
                ëª¨ë“ˆ1ìƒíƒœ.textContent = `ëª¨ë“ˆ1: ì—°ê²°ë¨ (${ëª¨ë“ˆ1ë°ì´í„°?.ìì‚°ê°œìˆ˜ || 0}ê°œ ìì‚°)`;
            } else {
                ëª¨ë“ˆ1ì .classList.remove('connected');
                ëª¨ë“ˆ1ìƒíƒœ.textContent = 'ëª¨ë“ˆ1: ì—°ê²° ëŒ€ê¸°ì¤‘...';
            }
            
            // â­ ëª¨ë“ˆ2 ìƒíƒœ (ê°œì„ )
            const ëª¨ë“ˆ2ì  = document.getElementById('module2SyncDot');
            const ëª¨ë“ˆ2ìƒíƒœ = document.getElementById('module2SyncStatus');
            
            if (ëª¨ë“ˆ2ì—°ê²°ìƒíƒœ) {
                ëª¨ë“ˆ2ì .classList.add('connected');
                const íˆ¬ìì—¬ë ¥ = ëª¨ë“ˆ2ë°ì´í„°?.íˆ¬ìì—¬ë ¥ || 0;
                ëª¨ë“ˆ2ìƒíƒœ.textContent = `ëª¨ë“ˆ2: ì—°ê²°ë¨ (íˆ¬ìì—¬ë ¥ ${íˆ¬ìì—¬ë ¥}ë§Œì›)`;
            } else {
                ëª¨ë“ˆ2ì .classList.remove('connected');
                ëª¨ë“ˆ2ìƒíƒœ.textContent = 'ëª¨ë“ˆ2: ì—°ê²° ëŒ€ê¸°ì¤‘...';
            }
            
            // ë§ˆì§€ë§‰ ë™ê¸°í™” ì‹œê°„
            document.getElementById('lastSyncTime').textContent = new Date().toLocaleTimeString();
        }
        
        // â­ ì™„ì „í•œ PostMessage ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
        window.addEventListener('message', function(event) {
            // ë³´ì•ˆ: ê°™ì€ originì—ì„œë§Œ ë©”ì‹œì§€ ìˆ˜ì‹ 
            if (event.origin !== window.location.origin && event.origin !== 'null') {
                ë¡œê·¸('ğŸš« ì˜ëª»ëœ originì—ì„œ ë©”ì‹œì§€ ìˆ˜ì‹  ì°¨ë‹¨:', event.origin);
                return;
            }
            
            ë¡œê·¸('ğŸ“¬ ë©”ì‹œì§€ ìˆ˜ì‹ :', event.data);
            
            try {
                const messageData = event.data;
                const messageType = messageData?.type;
                
                if (!messageType) {
                    ë¡œê·¸('âš ï¸ ë©”ì‹œì§€ íƒ€ì…ì´ ì—†ìŒ');
                    return;
                }
                
                // ========================================
                // ğŸ”¥ ëª¨ë“ˆ ë¡œë“œ ì™„ë£Œ ì‹ í˜¸ ì²˜ë¦¬
                // ========================================
                if (messageType === 'MODULE1_LOADED') {
                    ë¡œê·¸('âœ… ëª¨ë“ˆ1 ë¡œë“œ ì™„ë£Œ ì‹ í˜¸ ìˆ˜ì‹ ');
                    ëª¨ë“ˆ1ì—°ê²°ìƒíƒœ = true;
                    ë™ê¸°í™”ìƒíƒœì—…ë°ì´íŠ¸();
                    
                    // ë¡œë“œ ì™„ë£Œ í›„ ì¦‰ì‹œ ë°ì´í„° ì½ê¸° ì‹œë„
                    setTimeout(() => {
                        ëª¨ë“ˆ1ë°ì´í„°ì½ê¸°();
                        // ëª¨ë“ˆì—ê²Œ ë°ì´í„° ìš”ì²­
                        const module1Frame = document.getElementById('module1');
                        if (module1Frame && module1Frame.contentWindow) {
                            module1Frame.contentWindow.postMessage({
                                type: 'REQUEST_DATA'
                            }, '*');
                        }
                    }, 500);
                }
                
                // â­ ëª¨ë“ˆ2 ë¡œë“œ ì™„ë£Œ ì²˜ë¦¬ ê°•í™”
                if (messageType === 'MODULE2_LOADED') {
                    ë¡œê·¸('âœ… ëª¨ë“ˆ2 ë¡œë“œ ì™„ë£Œ ì‹ í˜¸ ìˆ˜ì‹ ');
                    ëª¨ë“ˆ2ì—°ê²°ìƒíƒœ = true;
                    ë™ê¸°í™”ìƒíƒœì—…ë°ì´íŠ¸();
                    
                    // ë¡œë“œ ì™„ë£Œ í›„ ì¦‰ì‹œ ë°ì´í„° ì½ê¸° ì‹œë„
                    setTimeout(() => {
                        ëª¨ë“ˆ2ë°ì´í„°ì½ê¸°();
                        // ëª¨ë“ˆì—ê²Œ ë°ì´í„° ìš”ì²­
                        const module2Frame = document.getElementById('module2');
                        if (module2Frame && module2Frame.contentWindow) {
                            module2Frame.contentWindow.postMessage({
                                type: 'REQUEST_DATA'
                            }, '*');
                        }
                    }, 500);
                }
                
                // ========================================
                // â­ ë°ì´í„° ì €ì¥ ì™„ë£Œ ì‹ í˜¸ ì²˜ë¦¬ (ê°•í™”)
                // ========================================
                if (messageType === 'DATA_SAVED') {
                    ë¡œê·¸('ğŸ’¾ ëª¨ë“ˆì—ì„œ ë°ì´í„° ì €ì¥ ì™„ë£Œ ì‹ í˜¸ ìˆ˜ì‹ ');
                    const moduleName = messageData.module;
                    
                    // ì €ì¥ ì™„ë£Œ í›„ ì¦‰ì‹œ ë°ì´í„° ë™ê¸°í™”
                    setTimeout(() => {
                        if (moduleName === 'module1') {
                            ëª¨ë“ˆ1ë°ì´í„°ì½ê¸°();
                        } else if (moduleName === 'module2') {
                            ë¡œê·¸('ğŸ’¾ ëª¨ë“ˆ2 ì €ì¥ ì™„ë£Œ - ë°ì´í„° ì½ê¸° ì‹œì‘');
                            ëª¨ë“ˆ2ë°ì´í„°ì½ê¸°();
                        }
                        ìƒíƒœë©”ì‹œì§€í‘œì‹œ(`${moduleName} ë°ì´í„°ê°€ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤`, 'success');
                    }, 200);
                }
                
                // â­ ì¦‰ì‹œ ë°ì´í„° ì €ì¥ ì‹ í˜¸ ì²˜ë¦¬ (ìƒˆë¡œ ì¶”ê°€)
                if (messageType === 'DATA_SAVED_IMMEDIATE') {
                    ë¡œê·¸('âš¡ ëª¨ë“ˆì—ì„œ ì¦‰ì‹œ ì €ì¥ ì‹ í˜¸ ìˆ˜ì‹ ');
                    const moduleName = messageData.module;
                    
                    // ì¦‰ì‹œ ë°ì´í„° ë™ê¸°í™”
                    if (moduleName === 'module1') {
                        ëª¨ë“ˆ1ë°ì´í„°ì½ê¸°();
                    } else if (moduleName === 'module2') {
                        ë¡œê·¸('âš¡ ëª¨ë“ˆ2 ì¦‰ì‹œ ì €ì¥ - ë°ì´í„° ì½ê¸° ì‹œì‘');
                        ëª¨ë“ˆ2ë°ì´í„°ì½ê¸°();
                    }
                }
                
                // ========================================
                // â­ ë°ì´í„° ì—…ë°ì´íŠ¸ ì‹ í˜¸ ì²˜ë¦¬ (ê°•í™”)
                // ========================================
                if (messageType === 'MODULE1_DATA_UPDATE' || messageType === 'MODULE1_DATA') {
                    ë¡œê·¸('ğŸ“Š ëª¨ë“ˆ1 ë°ì´í„° ì—…ë°ì´íŠ¸ ì‹ í˜¸ ìˆ˜ì‹ ');
                    
                    // ë©”ì‹œì§€ì— ë°ì´í„°ê°€ í¬í•¨ë˜ì–´ ìˆìœ¼ë©´ ì§ì ‘ ì‚¬ìš©
                    if (messageData.data) {
                        ë¡œê·¸('ğŸ“Š ëª¨ë“ˆ1 ë°ì´í„°ë¥¼ ë©”ì‹œì§€ì—ì„œ ì§ì ‘ ìˆ˜ì‹ ');
                        ëª¨ë“ˆ1ë°ì´í„°ì²˜ë¦¬(messageData.data);
                    } else {
                        // ë°ì´í„°ê°€ ì—†ìœ¼ë©´ localStorageì—ì„œ ì½ê¸°
                        setTimeout(() => ëª¨ë“ˆ1ë°ì´í„°ì½ê¸°(), 100);
                    }
                }
                
                // â­ ëª¨ë“ˆ2 ë°ì´í„° ì—…ë°ì´íŠ¸ ì‹ í˜¸ ì²˜ë¦¬ (ì™„ì „íˆ ìƒˆë¡œ ì‘ì„±)
                if (messageType === 'MODULE2_DATA_UPDATE' || messageType === 'MODULE2_DATA') {
                    ë¡œê·¸('ğŸ’° ëª¨ë“ˆ2 ë°ì´í„° ì—…ë°ì´íŠ¸ ì‹ í˜¸ ìˆ˜ì‹ ');
                    
                    // ë©”ì‹œì§€ì— ë°ì´í„°ê°€ í¬í•¨ë˜ì–´ ìˆìœ¼ë©´ ì§ì ‘ ì‚¬ìš©
                    if (messageData.data) {
                        ë¡œê·¸('ğŸ’° ëª¨ë“ˆ2 ë°ì´í„°ë¥¼ ë©”ì‹œì§€ì—ì„œ ì§ì ‘ ìˆ˜ì‹ ');
                        ëª¨ë“ˆ2ë°ì´í„°ì²˜ë¦¬(messageData.data);
                    } else {
                        // ë°ì´í„°ê°€ ì—†ìœ¼ë©´ localStorageì—ì„œ ì½ê¸°
                        setTimeout(() => ëª¨ë“ˆ2ë°ì´í„°ì½ê¸°(), 100);
                    }
                }
                
                // ========================================
                // ğŸ”¥ í•˜íŠ¸ë¹„íŠ¸ ì‹ í˜¸ ì²˜ë¦¬ (ì—°ê²° ìƒíƒœ í™•ì¸)
                // ========================================
                if (messageType === 'HEARTBEAT') {
                    const moduleName = messageData.module;
                    ë¡œê·¸(`ğŸ’“ ${moduleName} í•˜íŠ¸ë¹„íŠ¸ ìˆ˜ì‹ `);
                    
                    if (moduleName === 'module1') {
                        ëª¨ë“ˆ1ì—°ê²°ìƒíƒœ = true;
                    } else if (moduleName === 'module2') {
                        ëª¨ë“ˆ2ì—°ê²°ìƒíƒœ = true;
                    }
                    ë™ê¸°í™”ìƒíƒœì—…ë°ì´íŠ¸();
                }
                
                // ========================================
                // ğŸ”¥ ëª¨ë“ˆ ê°€ì‹œì„± ë³€ê²½ ì‹ í˜¸ ì²˜ë¦¬
                // ========================================
                if (messageType === 'MODULE_VISIBLE') {
                    const moduleName = messageData.module;
                    ë¡œê·¸(`ğŸ‘ï¸ ${moduleName} ê°€ì‹œì„± ë³€ê²½ ì‹ í˜¸`);
                    
                    // ëª¨ë“ˆì´ ë‹¤ì‹œ ë³´ì¼ ë•Œ ë°ì´í„° ë™ê¸°í™”
                    setTimeout(() => {
                        if (moduleName === 'module1') {
                            ëª¨ë“ˆ1ë°ì´í„°ì½ê¸°();
                        } else if (moduleName === 'module2') {
                            ëª¨ë“ˆ2ë°ì´í„°ì½ê¸°();
                        }
                    }, 300);
                }
                
                // ========================================
                // ğŸ”¥ ìƒˆë¡œê³ ì¹¨ ì™„ë£Œ ì‹ í˜¸ ì²˜ë¦¬
                // ========================================
                if (messageType === 'REFRESH_COMPLETED') {
                    const moduleName = messageData.module;
                    ë¡œê·¸(`ğŸ”„ ${moduleName} ìƒˆë¡œê³ ì¹¨ ì™„ë£Œ`);
                    
                    // ìƒˆë¡œê³ ì¹¨ ì™„ë£Œ í›„ ë°ì´í„° ì½ê¸°
                    setTimeout(() => {
                        if (moduleName === 'module1') {
                            ëª¨ë“ˆ1ë°ì´í„°ì½ê¸°();
                        } else if (moduleName === 'module2') {
                            ëª¨ë“ˆ2ë°ì´í„°ì½ê¸°();
                        }
                    }, 200);
                }
                
                // ========================================
                // ğŸ”¥ ê¸°íƒ€ ì‹ í˜¸ ì²˜ë¦¬
                // ========================================
                
                // ëª¨ë“ˆì—ì„œ ì§ì ‘ ë°ì´í„° ì „ì†¡ (ë°±ì—… ë°©ë²•)
                if (messageType.startsWith('MODULE1_') && messageData.data) {
                    ë¡œê·¸('ğŸ“Š ëª¨ë“ˆ1 ì§ì ‘ ë°ì´í„° ì „ì†¡');
                    ëª¨ë“ˆ1ë°ì´í„°ì²˜ë¦¬(messageData.data);
                }
                
                if (messageType.startsWith('MODULE2_') && messageData.data) {
                    ë¡œê·¸('ğŸ’° ëª¨ë“ˆ2 ì§ì ‘ ë°ì´í„° ì „ì†¡');
                    ëª¨ë“ˆ2ë°ì´í„°ì²˜ë¦¬(messageData.data);
                }
                
            } catch (error) {
                ë¡œê·¸('âŒ ë©”ì‹œì§€ ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜:', error);
            }
        });
        
        // ========================================
        // â­ ì§ì ‘ ë°ì´í„° ì²˜ë¦¬ í•¨ìˆ˜ë“¤ (ìƒˆë¡œ ì¶”ê°€)
        // ========================================
        
        // ëª¨ë“ˆ1 ë°ì´í„° ì§ì ‘ ì²˜ë¦¬
        function ëª¨ë“ˆ1ë°ì´í„°ì²˜ë¦¬(ë°ì´í„°) {
            try {
                ë¡œê·¸('ğŸ“Š ëª¨ë“ˆ1 ë°ì´í„° ì§ì ‘ ì²˜ë¦¬ ì‹œì‘', ë°ì´í„°);
                
                // ì•ˆì „í•œ ë°ì´í„° êµ¬ì¡° ì¶”ì¶œ
                const ì•ˆì „í•œìœ í˜•ë³„í•©ê³„ = ë°ì´í„°.ìœ í˜•ë³„í•©ê³„ || {};
                const ì•ˆì „í•œí˜„ì¬ìì‚° = ë°ì´í„°.í˜„ì¬ìì‚° || {};
                const ì•ˆì „í•œê³„ì¢Œë³„í•©ê³„ = ë°ì´í„°.ê³„ì¢Œë³„í•©ê³„ || {};
                
                // ì´ìì‚° ê³„ì‚°
                let ì´ìì‚° = 0;
                try {
                    ì´ìì‚° = Object.values(ì•ˆì „í•œìœ í˜•ë³„í•©ê³„).reduce((sum, val) => {
                        const ìˆ«ìê°’ = parseFloat(val) || 0;
                        return sum + ìˆ«ìê°’;
                    }, 0);
                } catch (error) {
                    ë¡œê·¸('âš ï¸ ì´ìì‚° ê³„ì‚° ì˜¤ë¥˜', error);
                    ì´ìì‚° = ë°ì´í„°.ì´ìì‚° || 0;
                }
                
                ëª¨ë“ˆ1ë°ì´í„° = {
                    ì´ìì‚°: ì´ìì‚°,
                    ìì‚°ê°œìˆ˜: Object.keys(ì•ˆì „í•œí˜„ì¬ìì‚°).length,
                    í˜„ì¬ìì‚°: ì•ˆì „í•œí˜„ì¬ìì‚°,
                    ìœ í˜•ë³„í•©ê³„: ì•ˆì „í•œìœ í˜•ë³„í•©ê³„,
                    ê³„ì¢Œë³„í•©ê³„: ì•ˆì „í•œê³„ì¢Œë³„í•©ê³„,
                    ë§ˆì§€ë§‰ì—…ë°ì´íŠ¸: ë°ì´í„°.ë§ˆì§€ë§‰ì—…ë°ì´íŠ¸ || new Date().toISOString()
                };
                
                // ì—°ê²° ìƒíƒœ ì—…ë°ì´íŠ¸
                ëª¨ë“ˆ1ì—°ê²°ìƒíƒœ = true;
                ë™ê¸°í™”ìƒíƒœì—…ë°ì´íŠ¸();
                
                // UI ì—…ë°ì´íŠ¸
                ëª¨ë“ˆ1ë°ì´í„°ì—…ë°ì´íŠ¸();
                ë¡œê·¸('âœ… ëª¨ë“ˆ1 ë°ì´í„° ì§ì ‘ ì²˜ë¦¬ ì™„ë£Œ');
                
            } catch (error) {
                ë¡œê·¸('âŒ ëª¨ë“ˆ1 ë°ì´í„° ì§ì ‘ ì²˜ë¦¬ ì‹¤íŒ¨:', error);
            }
        }
        
        // â­ ëª¨ë“ˆ2 ë°ì´í„° ì§ì ‘ ì²˜ë¦¬ (ì™„ì „íˆ ìƒˆë¡œ ì‘ì„±)
        function ëª¨ë“ˆ2ë°ì´í„°ì²˜ë¦¬(ë°ì´í„°) {
            try {
                ë¡œê·¸('ğŸ’° ëª¨ë“ˆ2 ë°ì´í„° ì§ì ‘ ì²˜ë¦¬ ì‹œì‘', ë°ì´í„°);
                
                // â­ ì•ˆì „í•œ ë°ì´í„° ì¶”ì¶œ
                const ì•ˆì „í•œì›”ë³„ë°ì´í„° = ë°ì´í„°.ì›”ë³„ë°ì´í„° || {};
                
                // í˜„ì¬ ì›” ê³„ì‚°
                let í˜„ì¬ë…„ì›” = new Date();
                if (ë°ì´í„°.í˜„ì¬ë…„ì›”) {
                    í˜„ì¬ë…„ì›” = new Date(ë°ì´í„°.í˜„ì¬ë…„ì›”.year, ë°ì´í„°.í˜„ì¬ë…„ì›”.month);
                }
                const í˜„ì¬ì›”í‚¤ = `${í˜„ì¬ë…„ì›”.getFullYear()}-${String(í˜„ì¬ë…„ì›”.getMonth() + 1).padStart(2, '0')}`;
                
                // â­ ì•ˆì „í•œ ê³„ì‚° (ì—¬ëŸ¬ ë°©ë²• ì‹œë„)
                let ì›”ìˆ˜ì… = ë°ì´í„°.ì›”ìˆ˜ì… || 0;
                let ì›”ì§€ì¶œ = ë°ì´í„°.ì›”ì§€ì¶œ || 0;
                let ìˆ˜ì…ê±´ìˆ˜ = ë°ì´í„°.ìˆ˜ì…ê±´ìˆ˜ || 0;
                let ì§€ì¶œê±´ìˆ˜ = ë°ì´í„°.ì§€ì¶œê±´ìˆ˜ || 0;
                
                // ì§ì ‘ ì „ë‹¬ëœ ë°ì´í„°ê°€ ì—†ìœ¼ë©´ ê³„ì‚°
                if (ì›”ìˆ˜ì… === 0 && ì›”ì§€ì¶œ === 0) {
                    const í˜„ì¬ì›”ë°ì´í„° = ì•ˆì „í•œì›”ë³„ë°ì´í„°[í˜„ì¬ì›”í‚¤];
                    if (í˜„ì¬ì›”ë°ì´í„°) {
                        try {
                            const ìˆ˜ì…ë°°ì—´ = Array.isArray(í˜„ì¬ì›”ë°ì´í„°.ìˆ˜ì…) ? í˜„ì¬ì›”ë°ì´í„°.ìˆ˜ì… : [];
                            const ì§€ì¶œë°°ì—´ = Array.isArray(í˜„ì¬ì›”ë°ì´í„°.ì§€ì¶œ) ? í˜„ì¬ì›”ë°ì´í„°.ì§€ì¶œ : [];
                            
                            ì›”ìˆ˜ì… = ìˆ˜ì…ë°°ì—´.reduce((sum, item) => sum + (parseFloat(item.ê¸ˆì•¡) || 0), 0);
                            ì›”ì§€ì¶œ = ì§€ì¶œë°°ì—´.reduce((sum, item) => sum + (parseFloat(item.ê¸ˆì•¡) || 0), 0);
                            ìˆ˜ì…ê±´ìˆ˜ = ìˆ˜ì…ë°°ì—´.length;
                            ì§€ì¶œê±´ìˆ˜ = ì§€ì¶œë°°ì—´.length;
                        } catch (error) {
                            ë¡œê·¸('âš ï¸ ëª¨ë“ˆ2 ê¸ˆì•¡ ê³„ì‚° ì˜¤ë¥˜', error);
                        }
                    }
                }
                
                const íˆ¬ìì—¬ë ¥ = ì›”ìˆ˜ì… - ì›”ì§€ì¶œ;
                
                ë¡œê·¸('ğŸ’° ëª¨ë“ˆ2 ê³„ì‚°ëœ ê°’ë“¤', { ì›”ìˆ˜ì…, ì›”ì§€ì¶œ, íˆ¬ìì—¬ë ¥, ìˆ˜ì…ê±´ìˆ˜, ì§€ì¶œê±´ìˆ˜ });
                
                ëª¨ë“ˆ2ë°ì´í„° = {
                    ì›”ë³„ë°ì´í„°: ì•ˆì „í•œì›”ë³„ë°ì´í„°,
                    ì›”ìˆ˜ì…: ì›”ìˆ˜ì…,
                    ì›”ì§€ì¶œ: ì›”ì§€ì¶œ,
                    íˆ¬ìì—¬ë ¥: íˆ¬ìì—¬ë ¥,
                    ìˆ˜ì…ê±´ìˆ˜: ìˆ˜ì…ê±´ìˆ˜,
                    ì§€ì¶œê±´ìˆ˜: ì§€ì¶œê±´ìˆ˜,
                    í˜„ì¬ë…„ì›”: ë°ì´í„°.í˜„ì¬ë…„ì›” || { year: í˜„ì¬ë…„ì›”.getFullYear(), month: í˜„ì¬ë…„ì›”.getMonth() },
                    ë§ˆì§€ë§‰ì—…ë°ì´íŠ¸: ë°ì´í„°.ë§ˆì§€ë§‰ì—…ë°ì´íŠ¸ || new Date().toISOString()
                };
                
                // ì—°ê²° ìƒíƒœ ì—…ë°ì´íŠ¸
                ëª¨ë“ˆ2ì—°ê²°ìƒíƒœ = true;
                ë™ê¸°í™”ìƒíƒœì—…ë°ì´íŠ¸();
                
                // UI ì—…ë°ì´íŠ¸
                ëª¨ë“ˆ2ë°ì´í„°ì—…ë°ì´íŠ¸();
                ë¡œê·¸('âœ… ëª¨ë“ˆ2 ë°ì´í„° ì§ì ‘ ì²˜ë¦¬ ì™„ë£Œ');
                
            } catch (error) {
                ë¡œê·¸('âŒ ëª¨ë“ˆ2 ë°ì´í„° ì§ì ‘ ì²˜ë¦¬ ì‹¤íŒ¨:', error);
                console.error('ëª¨ë“ˆ2 ë°ì´í„° ì§ì ‘ ì²˜ë¦¬ ì‹¤íŒ¨ ìƒì„¸:', error);
            }
        }
        
        // ========================================
        // ğŸ”¥ ëª¨ë“ˆì—ê²Œ ë°ì´í„° ìš”ì²­í•˜ëŠ” í•¨ìˆ˜ë“¤ (ìƒˆë¡œ ì¶”ê°€)
        // ========================================
        
        // ëª¨ë“ˆ1ì—ê²Œ ë°ì´í„° ìš”ì²­
        function ëª¨ë“ˆ1ë°ì´í„°ìš”ì²­() {
            try {
                const module1Frame = document.getElementById('module1');
                if (module1Frame && module1Frame.contentWindow) {
                    module1Frame.contentWindow.postMessage({
                        type: 'REQUEST_DATA',
                        timestamp: new Date().getTime()
                    }, '*');
                    ë¡œê·¸('ğŸ“Š ëª¨ë“ˆ1ì—ê²Œ ë°ì´í„° ìš”ì²­ ì „ì†¡');
                } else {
                    ë¡œê·¸('âš ï¸ ëª¨ë“ˆ1 iframeì— ì ‘ê·¼ ë¶ˆê°€');
                }
            } catch (error) {
                ë¡œê·¸('âŒ ëª¨ë“ˆ1 ë°ì´í„° ìš”ì²­ ì‹¤íŒ¨:', error);
            }
        }
        
        // â­ ëª¨ë“ˆ2ì—ê²Œ ë°ì´í„° ìš”ì²­
        function ëª¨ë“ˆ2ë°ì´í„°ìš”ì²­() {
            try {
                const module2Frame = document.getElementById('module2');
                if (module2Frame && module2Frame.contentWindow) {
                    module2Frame.contentWindow.postMessage({
                        type: 'REQUEST_DATA',
                        timestamp: new Date().getTime()
                    }, '*');
                    ë¡œê·¸('ğŸ’° ëª¨ë“ˆ2ì—ê²Œ ë°ì´í„° ìš”ì²­ ì „ì†¡');
                } else {
                    ë¡œê·¸('âš ï¸ ëª¨ë“ˆ2 iframeì— ì ‘ê·¼ ë¶ˆê°€');
                }
            } catch (error) {
                ë¡œê·¸('âŒ ëª¨ë“ˆ2 ë°ì´í„° ìš”ì²­ ì‹¤íŒ¨:', error);
            }
        }
        
        // ëª¨ë“  ëª¨ë“ˆì—ê²Œ ë°ì´í„° ìš”ì²­
        function ëª¨ë“ ëª¨ë“ˆë°ì´í„°ìš”ì²­() {
            ë¡œê·¸('ğŸ”„ ëª¨ë“  ëª¨ë“ˆì—ê²Œ ë°ì´í„° ìš”ì²­');
            ëª¨ë“ˆ1ë°ì´í„°ìš”ì²­();
            ëª¨ë“ˆ2ë°ì´í„°ìš”ì²­();
        }
        
        /*
        ===========================================
        â­ ê°œì„ ëœ ë°ì´í„° ì—…ë°ì´íŠ¸ í•¨ìˆ˜ë“¤ â­
        ===========================================
        */
        
        // ìˆ«ì í¬ë§·íŒ…
        function ìˆ«ìí¬ë§·(ìˆ«ì) {
            if (typeof ìˆ«ì !== 'number' || isNaN(ìˆ«ì)) {
                return '0';
            }
            return ìˆ«ì.toLocaleString();
        }
        
        // ë§Œì›ì„ ì–µì›ìœ¼ë¡œ ë³€í™˜
        function ë§Œì›ì„ì–µì›ìœ¼ë¡œ(ë§Œì›) {
            if (typeof ë§Œì› !== 'number' || isNaN(ë§Œì›)) {
                return 0;
            }
            return ë§Œì› / 10000;
        }
        
        // â­ ì•ˆì „í•œ ëª¨ë“ˆ1 ë°ì´í„° ì—…ë°ì´íŠ¸
        function ëª¨ë“ˆ1ë°ì´í„°ì—…ë°ì´íŠ¸() {
            if (!ëª¨ë“ˆ1ë°ì´í„°) {
                ë¡œê·¸('âš ï¸ ëª¨ë“ˆ1 ë°ì´í„°ê°€ ì—†ì–´ ì—…ë°ì´íŠ¸ ê±´ë„ˆëœ€');
                return;
            }
            
            try {
                const ì´ìì‚°ë§Œì› = ëª¨ë“ˆ1ë°ì´í„°.ì´ìì‚° || 0;
                const ì´ìì‚°ì–µì› = ë§Œì›ì„ì–µì›ìœ¼ë¡œ(ì´ìì‚°ë§Œì›);
                const ìì‚°ê°œìˆ˜ = ëª¨ë“ˆ1ë°ì´í„°.ìì‚°ê°œìˆ˜ || 0;
                
                // ì´ ìì‚° ì—…ë°ì´íŠ¸
                document.getElementById('totalAssetsValue').textContent = 
                    `${ì´ìì‚°ì–µì›.toFixed(1)}ì–µì›`;
                document.getElementById('totalAssetsDetail').textContent = 
                    `ìì‚° ${ìì‚°ê°œìˆ˜}ê°œ ë“±ë¡ (${ìˆ«ìí¬ë§·(ì´ìì‚°ë§Œì›)}ë§Œì›)`;
                
                ì—…ë°ì´íŠ¸ì‹œê°„ê°±ì‹ ();
                ìƒíƒœë©”ì‹œì§€í‘œì‹œ('ìì‚° ë°ì´í„°ê°€ ì—…ë°ì´íŠ¸ë˜ì—ˆìŠµë‹ˆë‹¤', 'success');
                ë¡œê·¸('âœ… ëª¨ë“ˆ1 UI ì—…ë°ì´íŠ¸ ì™„ë£Œ');
                
            } catch (error) {
                ë¡œê·¸('âŒ ëª¨ë“ˆ1 UI ì—…ë°ì´íŠ¸ ì˜¤ë¥˜', error);
            }
        }
        
        // â­ ì•ˆì „í•œ ëª¨ë“ˆ2 ë°ì´í„° ì—…ë°ì´íŠ¸ (ì™„ì „íˆ ìƒˆë¡œ ì‘ì„±)
        function ëª¨ë“ˆ2ë°ì´í„°ì—…ë°ì´íŠ¸() {
            if (!ëª¨ë“ˆ2ë°ì´í„°) {
                ë¡œê·¸('âš ï¸ ëª¨ë“ˆ2 ë°ì´í„°ê°€ ì—†ì–´ ì—…ë°ì´íŠ¸ ê±´ë„ˆëœ€');
                return;
            }
            
            try {
                const ì›”ìˆ˜ì… = ëª¨ë“ˆ2ë°ì´í„°.ì›”ìˆ˜ì… || 0;
                const ì›”ì§€ì¶œ = ëª¨ë“ˆ2ë°ì´í„°.ì›”ì§€ì¶œ || 0;
                const íˆ¬ìì—¬ë ¥ = ëª¨ë“ˆ2ë°ì´í„°.íˆ¬ìì—¬ë ¥ || (ì›”ìˆ˜ì… - ì›”ì§€ì¶œ);
                const ìˆ˜ì…ê±´ìˆ˜ = ëª¨ë“ˆ2ë°ì´í„°.ìˆ˜ì…ê±´ìˆ˜ || 0;
                const ì§€ì¶œê±´ìˆ˜ = ëª¨ë“ˆ2ë°ì´í„°.ì§€ì¶œê±´ìˆ˜ || 0;
                
                ë¡œê·¸('ğŸ’° UI ì—…ë°ì´íŠ¸í•  ê°’ë“¤', { ì›”ìˆ˜ì…, ì›”ì§€ì¶œ, íˆ¬ìì—¬ë ¥, ìˆ˜ì…ê±´ìˆ˜, ì§€ì¶œê±´ìˆ˜ });
                
                // ì›” ìˆ˜ì… ì—…ë°ì´íŠ¸
                document.getElementById('monthlyIncomeValue').textContent = 
                    `+${ìˆ«ìí¬ë§·(ì›”ìˆ˜ì…)}ë§Œì›`;
                document.getElementById('monthlyIncomeDetail').textContent = 
                    `ìˆ˜ì… ${ìˆ˜ì…ê±´ìˆ˜}ê±´`;
                
                // ì›” ì§€ì¶œ ì—…ë°ì´íŠ¸
                document.getElementById('monthlyExpenseValue').textContent = 
                    `-${ìˆ«ìí¬ë§·(ì›”ì§€ì¶œ)}ë§Œì›`;
                document.getElementById('monthlyExpenseDetail').textContent = 
                    `ì§€ì¶œ ${ì§€ì¶œê±´ìˆ˜}ê±´`;
                
                // íˆ¬ìì—¬ë ¥ ì—…ë°ì´íŠ¸
                const íˆ¬ìì—¬ë ¥ìƒ‰ìƒ = íˆ¬ìì—¬ë ¥ >= 0 ? '#28a745' : '#dc3545';
                const íˆ¬ìì—¬ë ¥ìš”ì†Œ = document.getElementById('investmentCapacityValue');
                íˆ¬ìì—¬ë ¥ìš”ì†Œ.textContent = `${ìˆ«ìí¬ë§·(íˆ¬ìì—¬ë ¥)}ë§Œì›`;
                íˆ¬ìì—¬ë ¥ìš”ì†Œ.style.color = íˆ¬ìì—¬ë ¥ìƒ‰ìƒ;
                
                document.getElementById('investmentCapacityDetail').textContent = 
                    íˆ¬ìì—¬ë ¥ >= 0 ? 'í‘ì' : 'ì ì';
                
                ì—…ë°ì´íŠ¸ì‹œê°„ê°±ì‹ ();
                ìƒíƒœë©”ì‹œì§€í‘œì‹œ('ìˆ˜ì…/ì§€ì¶œ ë°ì´í„°ê°€ ì—…ë°ì´íŠ¸ë˜ì—ˆìŠµë‹ˆë‹¤', 'success');
                ë¡œê·¸('âœ… ëª¨ë“ˆ2 UI ì—…ë°ì´íŠ¸ ì™„ë£Œ');
                
            } catch (error) {
                ë¡œê·¸('âŒ ëª¨ë“ˆ2 UI ì—…ë°ì´íŠ¸ ì˜¤ë¥˜', error);
                console.error('ëª¨ë“ˆ2 UI ì—…ë°ì´íŠ¸ ì˜¤ë¥˜ ìƒì„¸:', error);
            }
        }
        
        /*
        ===========================================
        â­ ê°œì„ ëœ UI ì œì–´ í•¨ìˆ˜ë“¤ â­
        ===========================================
        */
        
        // ëª¨ë“ˆ ì „í™˜
        function ëª¨ë“ˆì „í™˜(ëª¨ë“ˆì´ë¦„) {
            ë¡œê·¸(`ğŸ”„ ëª¨ë“ˆ ì „í™˜: ${ëª¨ë“ˆì´ë¦„}`);
            
            // íƒ­ í™œì„±í™” ìƒíƒœ ë³€ê²½
            document.querySelectorAll('.module-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            event.target.classList.add('active');
            
            // ëª¨ë“ˆ í”„ë ˆì„ ì „í™˜
            document.querySelectorAll('.module-frame').forEach(frame => {
                frame.classList.remove('active');
            });
            document.getElementById(ëª¨ë“ˆì´ë¦„).classList.add('active');
            
            í˜„ì¬ëª¨ë“ˆ = ëª¨ë“ˆì´ë¦„;
            
            // ëª¨ë“ˆ ì „í™˜ ì‹œ ê°•ì œ ë°ì´í„° ì½ê¸°
            setTimeout(() => {
                if (ëª¨ë“ˆì´ë¦„ === 'module1') {
                    ëª¨ë“ˆ1ë°ì´í„°ì½ê¸°();
                } else if (ëª¨ë“ˆì´ë¦„ === 'module2') {
                    ëª¨ë“ˆ2ë°ì´í„°ì½ê¸°();
                }
            }, 100);
        }
        
        // â­ ê°•í™”ëœ ì „ì²´ ë°ì´í„° ìƒˆë¡œê³ ì¹¨
        function ì „ì²´ë°ì´í„°ìƒˆë¡œê³ ì¹¨() {
            ë¡œê·¸('ğŸ”„ ê°•í™”ëœ ì „ì²´ ë°ì´í„° ìƒˆë¡œê³ ì¹¨ ì‹œì‘');
            ìƒíƒœë©”ì‹œì§€í‘œì‹œ('ë°ì´í„°ë¥¼ ìƒˆë¡œê³ ì¹¨í•˜ëŠ” ì¤‘...', 'info');
            
            // 1ë‹¨ê³„: localStorageì—ì„œ ì§ì ‘ ì½ê¸°
            const ëª¨ë“ˆ1ì„±ê³µ = ëª¨ë“ˆ1ë°ì´í„°ì½ê¸°();
            const ëª¨ë“ˆ2ì„±ê³µ = ëª¨ë“ˆ2ë°ì´í„°ì½ê¸°();
            
            // 2ë‹¨ê³„: ëª¨ë“ˆë“¤ì—ê²Œ ìƒˆë¡œê³ ì¹¨ ìš”ì²­
            try {
                const module1Frame = document.getElementById('module1');
                const module2Frame = document.getElementById('module2');
                
                if (module1Frame && module1Frame.contentWindow) {
                    module1Frame.contentWindow.postMessage({
                        type: 'REFRESH_REQUEST'
                    }, '*');
                }
                
                if (module2Frame && module2Frame.contentWindow) {
                    module2Frame.contentWindow.postMessage({
                        type: 'REFRESH_REQUEST'
                    }, '*');
                }
            } catch (error) {
                ë¡œê·¸('âš ï¸ iframe ìƒˆë¡œê³ ì¹¨ ì‹ í˜¸ ì „ì†¡ ì‹¤íŒ¨', error);
            }
            
            // 3ë‹¨ê³„: ëª¨ë“ˆë“¤ì—ê²Œ ë°ì´í„° ìš”ì²­
            setTimeout(() => {
                ëª¨ë“ ëª¨ë“ˆë°ì´í„°ìš”ì²­();
            }, 1000);
            
            // 4ë‹¨ê³„: ê²°ê³¼ í‘œì‹œ
            setTimeout(() => {
                if (ëª¨ë“ˆ1ì—°ê²°ìƒíƒœ || ëª¨ë“ˆ2ì—°ê²°ìƒíƒœ) {
                    ìƒíƒœë©”ì‹œì§€í‘œì‹œ('ë°ì´í„°ë¥¼ ìƒˆë¡œê³ ì¹¨í–ˆìŠµë‹ˆë‹¤.', 'success');
                    ë¡œê·¸('âœ… ìƒˆë¡œê³ ì¹¨ ì™„ë£Œ');
                } else {
                    ìƒíƒœë©”ì‹œì§€í‘œì‹œ('ì €ì¥ëœ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤. ëª¨ë“ˆì—ì„œ ë°ì´í„°ë¥¼ ë¨¼ì € ì €ì¥í•´ì£¼ì„¸ìš”.', 'info');
                    ë¡œê·¸('âš ï¸ ìƒˆë¡œê³ ì¹¨í•  ë°ì´í„° ì—†ìŒ');
                }
            }, 2000);
        }
        
        // ì—…ë°ì´íŠ¸ ì‹œê°„ ê°±ì‹ 
        function ì—…ë°ì´íŠ¸ì‹œê°„ê°±ì‹ () {
            const ì§€ê¸ˆ = new Date();
            const ì‹œê°„ë¬¸ìì—´ = ì§€ê¸ˆ.toLocaleString();
            document.getElementById('lastUpdateTime').textContent = ì‹œê°„ë¬¸ìì—´;
        }
        
        // ìƒíƒœ ë©”ì‹œì§€ í‘œì‹œ
        function ìƒíƒœë©”ì‹œì§€í‘œì‹œ(ë©”ì‹œì§€, íƒ€ì… = 'success') {
            const statusMessage = document.getElementById('statusMessage');
            statusMessage.textContent = ë©”ì‹œì§€;
            statusMessage.className = 'status-message show';
            
            if (íƒ€ì… === 'error') {
                statusMessage.classList.add('error');
            } else if (íƒ€ì… === 'info') {
                statusMessage.classList.add('info');
            }
            
            setTimeout(() => {
                statusMessage.classList.remove('show');
            }, 3000);
            
            ë¡œê·¸(`ğŸ“¢ ìƒíƒœë©”ì‹œì§€: ${ë©”ì‹œì§€} (${íƒ€ì…})`);
        }
        
        /*
        ===========================================
        â­ ê°•í™”ëœ ì´ˆê¸°í™” í•¨ìˆ˜ â­
        ===========================================
        */
        
        function ëŒ€ì‹œë³´ë“œì´ˆê¸°í™”() {
            ë¡œê·¸('ğŸš€ í†µí•© ëŒ€ì‹œë³´ë“œ ì´ˆê¸°í™” ì‹œì‘');
            
            // 1ë‹¨ê³„: ì¦‰ì‹œ localStorage ë°ì´í„° ì½ê¸°
            setTimeout(() => {
                ë¡œê·¸('ğŸ“‚ localStorageì—ì„œ ë°ì´í„° ì½ê¸° ì‹œì‘');
                
                const ëª¨ë“ˆ1ì„±ê³µ = ëª¨ë“ˆ1ë°ì´í„°ì½ê¸°();
                const ëª¨ë“ˆ2ì„±ê³µ = ëª¨ë“ˆ2ë°ì´í„°ì½ê¸°();
                
                ë¡œê·¸(`ğŸ“‚ ì´ˆê¸° ë°ì´í„° ì½ê¸° ê²°ê³¼: ëª¨ë“ˆ1(${ëª¨ë“ˆ1ì„±ê³µ}), ëª¨ë“ˆ2(${ëª¨ë“ˆ2ì„±ê³µ})`);
                
                // ë¡œë”© í™”ë©´ ìˆ¨ê¸°ê¸°
                document.getElementById('loadingState').classList.remove('active');
                
                if (!ëª¨ë“ˆ1ì„±ê³µ && !ëª¨ë“ˆ2ì„±ê³µ) {
                    ìƒíƒœë©”ì‹œì§€í‘œì‹œ('ì €ì¥ëœ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤. ê° ëª¨ë“ˆì—ì„œ ë°ì´í„°ë¥¼ ì¶”ê°€í•´ì£¼ì„¸ìš”.', 'info');
                } else {
                    ìƒíƒœë©”ì‹œì§€í‘œì‹œ('ëŒ€ì‹œë³´ë“œê°€ ì„±ê³µì ìœ¼ë¡œ ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤.', 'success');
                }
                
                // ì €ì¥ì†Œ ë³€ê²½ ê°ì§€ ì‹œì‘
                ì €ì¥ì†Œë³€ê²½ê°ì§€ì‹œì‘();
                
            }, 500);
            
            // 2ë‹¨ê³„: iframe ë¡œë“œ ì´ë²¤íŠ¸ ì²˜ë¦¬
            const module1Frame = document.getElementById('module1');
            const module2Frame = document.getElementById('module2');
            
            // ëª¨ë“ˆ1 ë¡œë“œ ì´ë²¤íŠ¸
            module1Frame.addEventListener('load', function() {
                ë¡œê·¸('ğŸ–¼ï¸ ëª¨ë“ˆ1 iframe ë¡œë“œ ì™„ë£Œ');
                
                // ì—¬ëŸ¬ ë²ˆ ì‹œë„í•˜ì—¬ ì•ˆì •ì ì¸ ì—°ê²° í™•ë³´
                const ì—°ê²°ì‹œë„ = (ì‹œë„íšŸìˆ˜) => {
                    if (ì‹œë„íšŸìˆ˜ > 0) {
                        ëª¨ë“ˆ1ë°ì´í„°ì½ê¸°();
                        setTimeout(() => ì—°ê²°ì‹œë„(ì‹œë„íšŸìˆ˜ - 1), 1000);
                    }
                };
                ì—°ê²°ì‹œë„(5); // 5ë²ˆ ì‹œë„
            });
            
            // â­ ëª¨ë“ˆ2 ë¡œë“œ ì´ë²¤íŠ¸ (ê°•í™”)
            module2Frame.addEventListener('load', function() {
                ë¡œê·¸('ğŸ–¼ï¸ ëª¨ë“ˆ2 iframe ë¡œë“œ ì™„ë£Œ');
                
                // ì—¬ëŸ¬ ë²ˆ ì‹œë„í•˜ì—¬ ì•ˆì •ì ì¸ ì—°ê²° í™•ë³´
                const ì—°ê²°ì‹œë„ = (ì‹œë„íšŸìˆ˜) => {
                    if (ì‹œë„íšŸìˆ˜ > 0) {
                        ë¡œê·¸(`ğŸ”„ ëª¨ë“ˆ2 ì—°ê²° ì‹œë„ ${6-ì‹œë„íšŸìˆ˜}/5`);
                        ëª¨ë“ˆ2ë°ì´í„°ì½ê¸°();
                        setTimeout(() => ì—°ê²°ì‹œë„(ì‹œë„íšŸìˆ˜ - 1), 1000);
                    }
                };
                ì—°ê²°ì‹œë„(5); // 5ë²ˆ ì‹œë„
            });
            
            // 3ë‹¨ê³„: ì´ˆê¸° ì‹œê°„ ì„¤ì •
            ì—…ë°ì´íŠ¸ì‹œê°„ê°±ì‹ ();
            ë™ê¸°í™”ìƒíƒœì—…ë°ì´íŠ¸();
            
            // 4ë‹¨ê³„: ì£¼ê¸°ì  ë°ì´í„° ê°±ì‹  (30ì´ˆë§ˆë‹¤) + ëª¨ë“ˆ ë°ì´í„° ìš”ì²­ (15ì´ˆë§ˆë‹¤)
            setInterval(() => {
                if (!ë””ë²„ê·¸ëª¨ë“œ) return; // ë””ë²„ê·¸ ëª¨ë“œì¼ ë•Œë§Œ ì£¼ê¸°ì  ê°±ì‹ 
                
                ë¡œê·¸('â° ì£¼ê¸°ì  ë™ê¸°í™” ì‹¤í–‰');
                ëª¨ë“ˆ1ë°ì´í„°ì½ê¸°();
                ëª¨ë“ˆ2ë°ì´í„°ì½ê¸°();
            }, 30 * 1000);
            
            // 5ë‹¨ê³„: ì •ê¸°ì ìœ¼ë¡œ ëª¨ë“ˆë“¤ì—ê²Œ ë°ì´í„° ìš”ì²­ (15ì´ˆë§ˆë‹¤)
            setInterval(() => {
                if (ë””ë²„ê·¸ëª¨ë“œ) {
                    ë¡œê·¸('â° ì •ê¸°ì  ë°ì´í„° ìš”ì²­ ì‹¤í–‰');
                    ëª¨ë“ ëª¨ë“ˆë°ì´í„°ìš”ì²­();
                }
            }, 15000);
            
            // 6ë‹¨ê³„: ì´ˆê¸° ë°ì´í„° ìš”ì²­ (3ì´ˆ í›„)
            setTimeout(() => {
                ë¡œê·¸('ğŸš€ ì´ˆê¸° ë°ì´í„° ìš”ì²­ ì‹¤í–‰');
                ëª¨ë“ ëª¨ë“ˆë°ì´í„°ìš”ì²­();
            }, 3000);
            
            // â­ 7ë‹¨ê³„: ì¶”ê°€ ëª¨ë“ˆ2 íŠ¹ë³„ ì²˜ë¦¬ (10ì´ˆ í›„)
            setTimeout(() => {
                ë¡œê·¸('ğŸš€ ëª¨ë“ˆ2 ì¶”ê°€ ë°ì´í„° ìš”ì²­ ì‹¤í–‰');
                ëª¨ë“ˆ2ë°ì´í„°ìš”ì²­();
                ëª¨ë“ˆ2ë°ì´í„°ì½ê¸°();
            }, 10000);
            
            ë¡œê·¸('âœ… ëŒ€ì‹œë³´ë“œ ì´ˆê¸°í™” ì™„ë£Œ');
            console.log('ğŸ‰ ì™„ì „í•œ PostMessage ìˆ˜ì‹  ë¡œì§ì´ í™œì„±í™”ë˜ì—ˆìŠµë‹ˆë‹¤!');
            console.log('ğŸ”§ ë””ë²„ê·¸ ëª¨ë“œëŠ” ìš°í•˜ë‹¨ ì„¤ì • ë²„íŠ¼ìœ¼ë¡œ í™œì„±í™”í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.');
        }
        
        // DOM ë¡œë“œ ì™„ë£Œ ì‹œ ì´ˆê¸°í™”
        document.addEventListener('DOMContentLoaded', ëŒ€ì‹œë³´ë“œì´ˆê¸°í™”);
        
        // í˜ì´ì§€ í¬ì»¤ìŠ¤ ì‹œ ë°ì´í„° ê°±ì‹ 
        window.addEventListener('focus', function() {
            ë¡œê·¸('ğŸ‘ï¸ í˜ì´ì§€ í¬ì»¤ìŠ¤ - ìë™ ë™ê¸°í™” ì‹¤í–‰');
            
            setTimeout(() => {
                ëª¨ë“ˆ1ë°ì´í„°ì½ê¸°();
                ëª¨ë“ˆ2ë°ì´í„°ì½ê¸°();
                // ì¶”ê°€: ëª¨ë“ˆë“¤ì—ê²Œë„ ë°ì´í„° ìš”ì²­
                ëª¨ë“ ëª¨ë“ˆë°ì´í„°ìš”ì²­();
            }, 300);
        });
        
        // í˜ì´ì§€ ê°€ì‹œì„± ë³€ê²½ ì‹œ ì²˜ë¦¬
        document.addEventListener('visibilitychange', function() {
            if (!document.hidden) {
                ë¡œê·¸('ğŸ‘ï¸ í˜ì´ì§€ ë‹¤ì‹œ ë³´ì„ - ë°ì´í„° ê°±ì‹ ');
                setTimeout(() => {
                    ëª¨ë“ˆ1ë°ì´í„°ì½ê¸°();
                    ëª¨ë“ˆ2ë°ì´í„°ì½ê¸°();
                    // ì¶”ê°€: ëª¨ë“ˆë“¤ì—ê²Œë„ ë°ì´í„° ìš”ì²­
                    ëª¨ë“ ëª¨ë“ˆë°ì´í„°ìš”ì²­();
                }, 300);
            }
        });
        
        // í˜ì´ì§€ ì–¸ë¡œë“œ ì‹œ ì •ë¦¬
        window.addEventListener('beforeunload', function() {
            if (ì €ì¥ì†Œê°ì§€íƒ€ì´ë¨¸) {
                clearInterval(ì €ì¥ì†Œê°ì§€íƒ€ì´ë¨¸);
            }
        });
    </script>
</body>
</html>